var t,e;t=this,e=function(t){"use strict";const e=t=>null==t,o=Object.freeze;t.createCustomPersister=(t,s,a,n,i)=>{let r,d,u=0,c=!1;const f={load:async(o,a)=>{if(2!=u){u=1;const n=await s();e(n)||""==n?t.setContent([o,a]):t.setJson(n),u=0}return f},startAutoLoad:async(o,s)=>(f.stopAutoLoad(),await f.load(o,s),c=!0,d=n((async o=>{e(o)?await f.load():2!=u&&(u=1,t.setContent(o),u=0)})),f),stopAutoLoad:()=>(c&&(i(d),d=void 0,c=!1),f),save:async()=>(1!=u&&(u=2,await a(t.getContent),u=0),f),startAutoSave:async()=>(await f.stopAutoSave().save(),r=t.addDidFinishTransactionListener(f.save),f),stopAutoSave:()=>{var o,s;return o=r,s=t.delListener,e(o)||s(o),f},getStore:()=>t,destroy:()=>f.stopAutoLoad().stopAutoSave(),getStats:()=>({})};return o(f)}},"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).TinyBasePersisters={});
