var e,t;e=this,t=function(e,t,l){"use strict";const a=e=>typeof e,s="",n=a(s),o=a(!0),r=a(0),i=a(a),d="type",u="default",c="Ids",h="Table",m=h+"s",g=h+c,b="Row",w=b+"Count",f=b+c,p="Cell",C=p+c,v="Value",I=v+"s",y=v+c,T="currentTarget",V="value",k=e=>s+e,S=isFinite,R=(e,t)=>e instanceof t,x=e=>null==e,N=(e,t,l)=>x(e)?l?.():t(e),E=e=>e==n||e==o,L=e=>a(e)==i,z=e=>Array.isArray(e),q=(e,t)=>e.forEach(t),$=(e,t)=>e.map(t),A=e=>e.length,J=(e,t,l)=>e.slice(t,l),M=(e,...t)=>e.push(...t),F=e=>e.shift(),O=Object,P=O.keys,B=O.isFrozen,D=O.freeze,H=e=>R(e,O)&&e.constructor==O,j=(e=[])=>O.fromEntries(e),U=(e,t)=>!x(((e,t)=>N(e,(e=>e[t])))(e,t)),W=(e,t)=>(delete e[t],e),G=(e,t)=>$(O.entries(e),(([e,l])=>t(l,e))),K=e=>H(e)&&0==(e=>A(P(e)))(e),Q=e=>JSON.stringify(e,((e,t)=>R(t,Map)?O.fromEntries([...t]):t)),X=JSON.parse,Y="tinybaseStoreInspector",Z="TinyBase Store Inspector",_=["left","top","bottom","right","full"],ee="state",te="sort",le="open",ae="position",se=le,ne=(...e)=>Q(e),oe='content:url("',re=oe+"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' stroke-width='4' stroke='white'>",ie='</svg>")',de=oe+"data:image/svg+xml,%3csvg viewBox='0 0 680 680' xmlns='http://www.w3.org/2000/svg' style='width:680px%3bheight:680px'%3e %3cpath stroke='white' stroke-width='80' fill='none' d='M340 617a84 241 90 11.01 0zM131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124zm-12-127a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z' /%3e %3cpath fill='%23d81b60' d='M131 475a94 254 70 10428-124 114 286 70 01-428 124zm0-140a94 254 70 10428-124 114 286 70 01-428 124z' /%3e %3cpath d='M249 619a94 240 90 00308-128 114 289 70 01-308 128zM119 208a94 254 70 00306 38 90 260 90 01-306-38zm221 3a74 241 90 11.01 0z' /%3e%3c/svg%3e\")",ue=$([[20,20,20,60],[20,20,60,20],[20,60,60,20],[60,20,20,60],[30,30,40,40]],(([e,t,l,a])=>re+`<rect x='20' y='20' width='60' height='60' fill='grey'/><rect x='${e}' y='${t}' width='${l}' height='${a}' fill='white'/>`+ie)),ce=re+"<path d='M20 20l60 60M20 80l60-60' />"+ie,he=((e,t="")=>e.join(t))(G({"":"all:initial;font-family:sans-serif;font-size:0.75rem;position:fixed;z-index:999999","*":"all:revert","*::before":"all:revert","*::after":"all:revert",img:"width:1rem;height:1rem;background:#111;border:0",">img":"padding:0.25rem;bottom:0;right:0;position:fixed;"+de,...j($(["bottom:0;left:0","top:0;right:0"],((e,t)=>[`>img[data-position='${t}']`,e]))),main:"display:flex;flex-direction:column;background:#111d;color:#fff;position:fixed;",...j($(["bottom:0;left:0;width:35vw;height:100vh","top:0;right:0;width:100vw;height:30vh","bottom:0;left:0;width:100vw;height:30vh","top:0;right:0;width:35vw;height:100vh","top:0;right:0;width:100vw;height:100vh"],((e,t)=>[`main[data-position='${t}']`,e]))),header:"display:flex;padding:0.25rem;background:#000;align-items:center","header>img:nth-of-type(1)":de,"header>img:nth-of-type(6)":ce,...j($(ue,((e,t)=>[`header>img[data-id='${t}']`,e]))),"header>span":"flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-left:0.25rem",article:"padding:0.25rem 0.25rem 0.25rem 0.5rem;overflow:auto",details:"margin-left:0.75rem;width:fit-content;",summary:"margin-left:-0.75rem;line-height:1.25rem;user-select:none;width:fit-content",table:"border-collapse:collapse;table-layout:fixed;margin-bottom:0.5rem",thead:"background:#222","th:nth-of-type(1)":"min-width:2rem;","th.sorted":"background:#000","table caption":"text-align:left;white-space:nowrap;line-height:1.25rem",button:"width:1.5rem;border:none;background:none;color:#fff;padding:0","button[disabled]":"color:#777","button.next":"margin-right:0.5rem",[`th,#${Y} td`]:"overflow:hidden;text-overflow:ellipsis;padding:0.25rem 0.5rem;max-width:12rem;white-space:nowrap;border-width:1px 0;border-style:solid;border-color:#777;text-align:left"},((e,t)=>e?`#${Y} ${t}{${e}}`:""))),{createElement:me}=l,ge=(e,...t)=>x(e)?{}:e(...t),be=({s:e})=>{const l=t.useValue(ae,e)??1,a=t.useSetValueCallback(se,(()=>!0),[],e);return t.useValue(se,e)?null:me("img",{onClick:a,title:Z,"data-position":l})},we=e=>{const t=a(e);return E(t)||t==r&&S(e)?t:void 0},fe=(e,t,l,a,s)=>x(s)?e.delCell(t,l,a,!0):e.setCell(t,l,a,s),pe=(e,t,l)=>x(l)?e.delValue(t):e.setValue(t,l),Ce=(e,t,l,a)=>e==n?t:e==r?l:a,{useCallback:ve,useMemo:Ie,useState:ye}=l,Te="editable",Ve=(e,t,l)=>{const a=ve(e,t);return l?a:void 0},ke=(e,t=!1,l,a=0,s,n,o,r)=>{const[[i,d,u],c]=ye([e,t,a]),h=ve((e=>{c(e),r?.(e)}),[r]),m=Ve((e=>h([e,e==i&&!d,u])),[h,i,d,u],l),g=ve((e=>h([i,d,e])),[h,i,d]),b=!0===o?qe:o;return[[i,d,u],m,Ie((()=>!1===o?null:me(b,{offset:u,limit:s,total:n,onChange:g})),[o,b,u,s,n,g])]},Se=({cellId:e,sort:[t,l],label:a=e??s,onClick:n})=>me("th",{onClick:Ve((()=>n?.(e)),[n,e],n),className:x(l)||t!=e?void 0:`sorted ${l?"de":"a"}scending`},x(l)||t!=e?null:(l?"↓":"↑")+" ",a),Re=({className:e,headerRow:t,idColumn:l,customCells:s,params:o,rowIds:r})=>{const[i,d,u,c,h,m,g]=o,b=c(...d),w=Ie((()=>{const e=s??b;return j(G(z(e)?j($(e,(e=>[e,e]))):e,((e,t)=>{return[t,{label:t,...(l=e,a(l)==n?{label:e}:e)}];var l})))}),[s,b]);return me("table",{className:e},g?me("caption",null,g):null,!1===t?null:me("thead",null,me("tr",null,!1===l?null:me(Se,{sort:h??[],label:"Id",onClick:m}),G(w,(({label:e},t)=>me(Se,{key:t,cellId:t,label:e,sort:h??[],onClick:m}))))),me("tbody",null,$(r,(e=>me("tr",{key:e},!1===l?null:me("th",null,e),G(w,(({component:t=u,getComponentProps:l},a)=>me("td",{key:a},me(t,{...ge(l,e,a),...i,rowId:e,cellId:a})))))))))},xe=({thing:e,onThingChange:t,className:l})=>{const[a,s]=ye(),[i,d]=ye(),[u,c]=ye(),[h,m]=ye(),[g,b]=ye();i!==e&&(s(we(e)),d(e),c(e+""),m(Number(e)||0),b(!!e));const w=ve(((e,l)=>{l(e),d(e),t(e)}),[t]);return me("div",{className:l},me("button",{className:a,onClick:ve((()=>{const e=Ce(a,r,o,n),l=Ce(e,u,h,g);s(e),d(l),t(l)}),[t,u,h,g,a])},a),Ce(a,me("input",{key:a,value:u,onChange:ve((e=>w(e[T][V]+"",c)),[w])}),me("input",{key:a,type:"number",value:h,onChange:ve((e=>w(Number(e[T][V]||0),m)),[w])}),me("input",{key:a,type:"checkbox",checked:g,onChange:ve((e=>w(!!e[T].checked,b)),[w])})))},Ne=({tableId:e,cellId:l,descending:a,offset:s,limit:n,store:o,editable:r,sortOnClick:i,paginator:d=!1,onChange:u,...c})=>{const[h,m,g]=ke(l,a,i,s,n,t.useRowCount(e,o),d,u);return me(Re,{...c,params:Ie((()=>[{tableId:e,store:o},[e,o],r?Le:t.CellView,t.useTableCellIds,h,m,g]),[o,e,r,h,m,g]),rowIds:t.useSortedRowIds(e,...h,n,o)})},Ee=({store:e,editable:l=!1,valueComponent:a=(l?ze:t.ValueView),getValueComponentProps:s,className:n,headerRow:o,idColumn:r})=>me("table",{className:n},!1===o?null:me("thead",null,me("tr",null,!1===r?null:me("th",null,"Id"),me("th",null,v))),me("tbody",null,$(t.useValueIds(e),(t=>me("tr",{key:t},!1===r?null:me("th",null,t),me("td",null,me(a,{...ge(s,t),valueId:t,store:e}))))))),Le=({tableId:e,rowId:l,cellId:a,store:s,className:n})=>me(xe,{thing:t.useCell(e,l,a,s),onThingChange:t.useSetCellCallback(e,l,a,(e=>e),[],s),className:n??Te+p}),ze=({valueId:e,store:l,className:a})=>me(xe,{thing:t.useValue(e,l),onThingChange:t.useSetValueCallback(e,(e=>e),[],l),className:a??Te+v}),qe=({onChange:e,total:t,offset:a=0,limit:s=t,singular:n="row",plural:o=n+"s"})=>{(a>t||a<0)&&(a=0,e(0));const r=Ve((()=>e(a-s)),[e,a,s],a>0),i=Ve((()=>e(a+s)),[e,a,s],a+s<t);return me(l.Fragment,null,t>s&&me(l.Fragment,null,me("button",{className:"previous",disabled:0==a,onClick:r},"←"),me("button",{className:"next",disabled:a+s>=t,onClick:i},"→"),a+1," to ",Math.min(t,a+s)," of "),t," ",1!=t?o:n)},$e=({uniqueId:e,summary:a,children:s,s:n})=>{const o=!!t.useCell(ee,e,le,n),r=t.useSetCellCallback(ee,e,le,(e=>e[T].open),[],n);return l.createElement("details",{open:o,onToggle:r},l.createElement("summary",null,a),s)},Ae=({tableId:e,store:l,storeId:a,s:s})=>{const n=ne("t",a,e),[o,r,i]=X(t.useCell(ee,n,te,s)??"[]"),d=t.useSetCellCallback(ee,n,te,Q,[],s);return me($e,{uniqueId:n,summary:h+": "+e,s:s},me(Ne,{tableId:e,store:l,cellId:o,descending:r,offset:i,limit:10,paginator:!0,sortOnClick:!0,onChange:d}))},Je=({store:e,storeId:l,s:a})=>{return s=t.useValueIds(e),0==A(s)?null:me($e,{uniqueId:ne("v",l),summary:I,s:a},me(Ee,{store:e}));var s},Me=({storeId:e,s:l})=>{const a=t.useStore(e),s=t.useTableIds(a);return x(a)?null:me($e,{uniqueId:ne("s",e),summary:"Store: "+(e??u),s:l},me(Je,{storeId:e,store:a,s:l}),$(s,(t=>me(Ae,{storeId:e,tableId:t,store:a,s:l}))))},Fe=e=>me("article",null,me(Me,{...e}),$(t.useStoreIds(),(t=>me(Me,{storeId:t,key:t,...e})))),Oe=({s:e})=>{const l=t.useValue(ae,e)??1,a=t.useSetValueCallback(se,(()=>!1),[],e),s=t.useSetValueCallback(ae,(e=>Number(e[T].dataset.id)),[],e);return me("header",null,me("img",{title:Z}),me("span",null,Z),$(_,((e,t)=>t==l?null:me("img",{onClick:s,"data-id":t,title:"Dock to "+e,key:t}))),me("img",{onClick:a,title:"Close"}))},Pe=({s:e})=>{const l=t.useValue(ae,e)??1;return t.useValue(se,e)?me("main",{"data-position":l},me(Oe,{s:e}),me(Fe,{s:e})):null},Be="storage",De=globalThis.window,He=(e,t)=>((e,t,l)=>((e,a,s,n,o)=>{let r,i,d,u=0,c=0,h=0,m=0,g=0;const b=[],w=async e=>(2!=u&&(u=1,c++,await f.schedule((async()=>{await e(),u=0}))),f),f={load:async(t,l)=>await w((async()=>{try{e.setContent(await a())}catch{e.setContent([t,l])}})),startAutoLoad:async(s={},n={})=>(f.stopAutoLoad(),await f.load(s,n),g=1,d=(e=>{const a=a=>{a.storageArea===l&&a.key===t&&e((()=>X(a.newValue)))};return De.addEventListener(Be,a),a})((async(t,l)=>await w((async()=>{if(l)e.setTransactionChanges(l());else try{e.setContent(t?.()??await a())}catch{}})))),f),stopAutoLoad:()=>{return g&&(e=d,De.removeEventListener(Be,e),d=void 0,g=0),f;var e},save:async a=>(1!=u&&(u=2,h++,await f.schedule((async()=>{try{await(async e=>l.setItem(t,Q(e())))(e.getContent)}catch{}u=0}))),f),startAutoSave:async()=>(await f.stopAutoSave().save(),r=e.addDidFinishTransactionListener(((e,t)=>{const[l,a]=t();K(l)&&K(a)||f.save((()=>[l,a]))})),f),stopAutoSave:()=>(N(r,e.delListener),f),schedule:async(...e)=>(M(b,...e),await(async()=>{if(!m){for(m=1;!x(i=F(b));)try{await i()}catch{}m=0}})(),f),getStore:()=>e,destroy:()=>f.stopAutoLoad().stopAutoSave(),getStats:()=>({loads:c,saves:h})};return D(f)})(e,(async()=>X(l.getItem(t)))))(e,t,sessionStorage),je=e=>t=>{return l=(t,l)=>t+e(l),Ye(t).reduce(l,0);var l},Ue=e=>e?.size??0,We=je(Ue),Ge=je(We),Ke=je(Ge),Qe=(e,t)=>e?.has(t)??!1,Xe=e=>x(e)||0==Ue(e),Ye=e=>[...e?.values()??[]],Ze=e=>e.clear(),_e=(e,t)=>e?.forEach(t),et=(e,t)=>e?.delete(t),tt=e=>new Map(e),lt=e=>[...e?.keys()??[]],at=(e,t)=>e?.get(t),st=(e,t)=>_e(e,((e,l)=>t(l,e))),nt=(e,t,l)=>x(l)?(et(e,t),e):e?.set(t,l),ot=(e,t,l)=>(Qe(e,t)||nt(e,t,l()),at(e,t)),rt=(e,t,l,a=nt)=>(G(t,((t,a)=>l(e,a,t))),st(e,(l=>U(t,l)?0:a(e,l))),e),it=(e,t,l)=>{const a={};return _e(e,((e,s)=>{const n=t?t(e,s):e;!l?.(n,e)&&(a[s]=n)})),a},dt=(e,t,l)=>it(e,(e=>it(e,t,l)),K),ut=(e,t,l)=>it(e,(e=>dt(e,t,l)),K),ct=(e,t)=>{const l=tt();return _e(e,((e,a)=>l.set(a,t?.(e)??e))),l},ht=e=>ct(e,ct),mt=e=>ct(e,ht),gt=(e,t,l,a,s=0)=>N((l?ot:at)(e,t[s],s>A(t)-2?l:tt),(n=>{if(s>A(t)-2)return a?.(n)&&nt(e,t[s]),n;const o=gt(n,t,l,a,s+1);return Xe(n)&&nt(e,t[s]),o})),bt=e=>new Set(z(e)||x(e)?e:[e]),wt=(e,t)=>e?.add(t),ft=/^\d+$/,pt=()=>{const e=[];let t=0;return[l=>(l?F(e):null)??s+t++,t=>{ft.test(t)&&A(e)<1e3&&M(e,t)}]},Ct=e=>[e,e],vt=(e,t=We)=>t(e[0])+t(e[1]),It=()=>[tt(),tt()],yt=e=>[...e],Tt=([e,t])=>e===t,Vt=(e,t,l)=>x(e)||!H(e)||K(e)||B(e)?(l?.(),!1):(G(e,((l,a)=>{t(l,a)||W(e,a)})),!K(e)),kt=(e,t,l)=>nt(e,t,at(e,t)==-l?void 0:l),St=()=>{let e,t,l=!1,a=!1,n=0;const o=tt(),i=tt(),c=tt(),T=tt(),V=tt(),S=tt(),R=tt(),z=tt(),F=tt(),O=tt(),P=tt(),B=tt(),H=tt(),j=tt(),Y=bt(),Z=tt(),_=tt(),ee=tt(),te=tt(),le=It(),ae=It(),se=It(),ne=It(),oe=It(),re=It(),ie=It(),de=It(),ue=It(),ce=It(),he=It(),me=It(),ge=It(),be=It(),Ce=It(),ve=tt(),Ie=It(),[ye,Te,Ve,ke]=(e=>{let t;const[l,a]=pt(),n=tt();return[(e,a,o,r=[],i=(()=>[]))=>{t??=Cl;const d=l(1);return nt(n,d,[e,a,o,r,i]),wt(gt(a,o??[s],bt),d),d},(e,l,...a)=>q(((e,t=[s])=>{const l=[],a=(e,s)=>s==A(t)?M(l,e):null===t[s]?_e(e,(e=>a(e,s+1))):q([t[s],null],(t=>a(at(e,t),s+1)));return a(e,0),l})(e,l),(e=>_e(e,(e=>at(n,e)[0](t,...l??[],...a))))),e=>N(at(n,e),(([,t,l])=>(gt(t,l??[s],void 0,(t=>(et(t,e),Xe(t)?1:0))),nt(n,e),a(e),l))),e=>N(at(n,e),(([e,,l=[],a,s])=>{const n=(...o)=>{const r=A(o);r==A(l)?e(t,...o,...s(o)):x(l[r])?q(a[r]?.(...o)??[],(e=>n(...o,e))):n(...o,l[r])};n()}))]})(),Se=e=>{if(!Vt(e,((e,t)=>[d,u].includes(t))))return!1;const t=e[d];return!(!E(t)&&t!=r||(we(e[u])!=t&&W(e,u),0))},Re=(t,l)=>(!e||Qe(P,l)||Mt(l))&&Vt(t,((e,t)=>xe(l,t,e)),(()=>Mt(l))),xe=(e,t,l,a)=>Vt(a?l:ze(l,e,t),((a,s)=>N(Ne(e,t,s,a),(e=>(l[s]=e,!0)),(()=>!1))),(()=>Mt(e,t))),Ne=(t,l,a,s)=>e?N(at(at(P,t),a),(e=>we(s)!=e[d]?Mt(t,l,a,s,e[u]):s),(()=>Mt(t,l,a,s))):x(we(s))?Mt(t,l,a,s):s,Ee=(e,t)=>Vt(t?e:qe(e),((t,l)=>N(Le(l,t),(t=>(e[l]=t,!0)),(()=>!1))),(()=>Ft())),Le=(e,l)=>t?N(at(H,e),(t=>we(l)!=t[d]?Ft(e,l,t[u]):l),(()=>Ft(e,l))):x(we(l))?Ft(e,l):l,ze=(e,t,l)=>(N(at(B,t),(([a,s])=>{_e(a,((t,l)=>{U(e,l)||(e[l]=t)})),_e(s,(a=>{U(e,a)||Mt(t,l,a)}))})),e),qe=e=>(t&&(_e(j,((t,l)=>{U(e,l)||(e[l]=t)})),_e(Y,(t=>{U(e,t)||Ft(t)}))),e),$e=e=>rt(P,e,((e,t,l)=>{const a=tt(),s=bt();rt(ot(P,t,tt),l,((e,t,l)=>{nt(e,t,l),N(l[u],(e=>nt(a,t,e)),(()=>wt(s,t)))})),nt(B,t,[a,s])}),((e,t)=>{nt(P,t),nt(B,t)})),Ae=e=>rt(H,e,((e,t,l)=>{nt(H,t,l),N(l[u],(e=>nt(j,t,e)),(()=>wt(Y,t)))}),((e,t)=>{nt(H,t),nt(j,t),et(Y,t)})),Je=e=>K(e)?ul():nl(e),Me=e=>rt(ee,e,((e,t,l)=>Fe(t,l)),((e,t)=>Rt(t))),Fe=(e,t)=>rt(ot(ee,e,(()=>(Lt(e,1),nt(Z,e,pt()),nt(_,e,tt()),tt()))),t,((t,l,a)=>Oe(e,t,l,a)),((t,l)=>xt(e,t,l))),Oe=(e,t,l,a,s)=>rt(ot(t,l,(()=>(zt(e,l,1),tt()))),a,((t,a,s)=>Pe(e,l,t,a,s)),((a,n)=>Nt(e,t,l,a,n,s))),Pe=(e,t,l,a,s)=>{Qe(l,a)||qt(e,t,a,1);const n=at(l,a);s!==n&&($t(e,t,a,n,s),nt(l,a,s))},Be=(e,t,l,a,s)=>N(at(t,l),(t=>Pe(e,l,t,a,s)),(()=>Oe(e,t,l,ze({[a]:s},e,l)))),De=e=>K(e)?ml():ol(e),He=e=>rt(te,e,((e,t,l)=>je(t,l)),((e,t)=>Et(t))),je=(e,t)=>{Qe(te,e)||At(e,1);const l=at(te,e);t!==l&&(Jt(e,l,t),nt(te,e,t))},Ye=(e,t)=>{const[l]=at(Z,e),a=l(t);return Qe(at(ee,e),a)?Ye(e,t):a},ft=e=>at(ee,e)??Fe(e,{}),Rt=e=>Fe(e,{}),xt=(e,t,l)=>{const[,a]=at(Z,e);a(l),Oe(e,t,l,{},!0)},Nt=(e,t,l,a,s,n)=>{const o=at(at(B,e)?.[0],s);if(!x(o)&&!n)return Pe(e,l,a,s,o);const r=t=>{$t(e,l,t,at(a,t)),qt(e,l,t,-1),nt(a,t)};x(o)?r(s):st(a,r),Xe(a)&&(zt(e,l,-1),Xe(nt(t,l))&&(Lt(e,-1),nt(ee,e),nt(Z,e),nt(_,e)))},Et=e=>{const t=at(j,e);if(!x(t))return je(e,t);Jt(e,at(te,e)),At(e,-1),nt(te,e)},Lt=(e,t)=>kt(o,e,t),zt=(e,t,l)=>kt(ot(T,e,tt),t,l)&&nt(c,e,ot(c,e,(()=>0))+l),qt=(e,t,l,a)=>{const s=at(_,e),n=at(s,l)??0;(0==n&&1==a||1==n&&-1==a)&&kt(ot(i,e,tt),l,a),nt(s,l,n!=-a?n+a:null),kt(ot(ot(V,e,tt),t,tt),l,a)},$t=(e,t,l,a,s)=>ot(ot(ot(S,e,tt),t,tt),l,(()=>[a,0]))[1]=s,At=(e,t)=>kt(R,e,t),Jt=(e,t,l)=>ot(z,e,(()=>[t,0]))[1]=l,Mt=(e,t,l,a,s)=>(M(ot(ot(ot(F,e,tt),t,tt),l,(()=>[])),a),s),Ft=(e,t,l)=>(M(ot(O,e,(()=>[])),t),l),Ot=(e,t,l)=>N(at(at(at(S,e),t),l),(([e,t])=>[!0,e,t]),(()=>[!1,...Ct(tl(e,t,l))])),Pt=e=>N(at(z,e),(([e,t])=>[!0,e,t]),(()=>[!1,...Ct(sl(e))])),Bt=e=>Xe(F)||Xe(he[e])?0:_e(e?mt(F):F,((t,l)=>_e(t,((t,a)=>_e(t,((t,s)=>Te(he[e],[l,a,s],t))))))),Dt=e=>Xe(O)||Xe(me[e])?0:_e(e?ct(O):O,((t,l)=>Te(me[e],[l],t))),Ht=(e,t,l)=>{if(!Xe(t))return Te(e,l,(()=>it(t))),1},jt=e=>{const t=Xe(ie[e]),l=Xe(ue[e])&&Xe(ne[e])&&Xe(oe[e])&&Xe(re[e])&&t&&Xe(ae[e]),a=Xe(ce[e])&&Xe(de[e])&&Xe(se[e])&&Xe(le[e]);if(!l||!a){const s=e?[ct(o),ht(i),ct(c),ht(T),mt(V),mt(S)]:[o,i,c,T,V,S];if(!l){Ht(ae[e],s[0]),_e(s[1],((t,l)=>Ht(ne[e],t,[l]))),_e(s[2],((t,l)=>{0!=t&&Te(oe[e],[l],Yt(l))}));const l=bt();_e(s[3],((a,s)=>{Ht(re[e],a,[s])&&!t&&(Te(ie[e],[s,null]),wt(l,s))})),t||_e(s[5],((t,a)=>{if(!Qe(l,a)){const l=bt();_e(t,(e=>_e(e,(([t,a],s)=>a!==t?wt(l,s):et(e,s))))),_e(l,(t=>Te(ie[e],[a,t])))}})),_e(s[4],((t,l)=>_e(t,((t,a)=>Ht(ue[e],t,[l,a])))))}if(!a){let t;_e(s[5],((l,a)=>{let s;_e(l,((l,n)=>{let o;_e(l,(([l,r],i)=>{r!==l&&(Te(ce[e],[a,n,i],r,l,Ot),t=s=o=1)})),o&&Te(de[e],[a,n],Ot)})),s&&Te(se[e],[a],Ot)})),t&&Te(le[e],void 0,Ot)}}},Ut=e=>{const t=Xe(be[e]),l=Xe(Ce[e])&&Xe(ge[e]);if(!t||!l){const a=e?[ct(R),ct(z)]:[R,z];if(t||Ht(be[e],a[0]),!l){let t;_e(a[1],(([l,a],s)=>{a!==l&&(Te(Ce[e],[s],a,l,Pt),t=1)})),t&&Te(ge[e],void 0,Pt)}}},Wt=(e,...t)=>(wl((()=>e(...$(t,k)))),Cl),Gt=()=>[it(S,((e,t)=>-1===at(o,t)?null:it(e,((e,l)=>-1===at(at(T,t),l)?null:it(e,(([,e])=>e??null),((e,t)=>Tt(t)))),K)),K),it(z,(([,e])=>e??null),((e,t)=>Tt(t)))],Kt=()=>({cellsTouched:l,valuesTouched:a,changedCells:ut(S,yt,Tt),invalidCells:ut(F),changedValues:it(z,yt,Tt),invalidValues:it(O),changedTableIds:it(o),changedRowIds:dt(T),changedCellIds:ut(V),changedValueIds:it(R)}),Qt=()=>ut(ee),Xt=()=>lt(ee),Yt=e=>Ue(at(ee,k(e))),Zt=e=>lt(at(ee,k(e))),_t=(e,t,l,a=0,s)=>{return $(J((o=at(ee,k(e)),r=(e,l)=>[x(t)?l:at(e,k(t)),l],n=([e],[t])=>((e??0)<(t??0)?-1:1)*(l?-1:1),$([...o?.entries()??[]],(([e,t])=>r(t,e))).sort(n)),a,x(s)?s:a+s),(([,e])=>e));var n,o,r},el=(e,t)=>lt(at(at(ee,k(e)),k(t))),tl=(e,t,l)=>at(at(at(ee,k(e)),k(t)),k(l)),ll=()=>it(te),al=()=>lt(te),sl=e=>at(te,k(e)),nl=e=>Wt((()=>(e=>Vt(e,Re,Mt))(e)?Me(e):0)),ol=e=>Wt((()=>Ee(e)?He(e):0)),rl=e=>{try{Je(X(e))}catch{}return Cl},il=t=>Wt((()=>{if((e=Vt(t,(e=>Vt(e,Se))))&&($e(t),!Xe(ee))){const e=Qt();ul(),nl(e)}})),dl=e=>Wt((()=>{if(t=(e=>Vt(e,Se))(e)){const l=ll();bl(),ml(),t=!0,Ae(e),ol(l)}})),ul=()=>Wt((()=>Me({}))),cl=e=>Wt((e=>Qe(ee,e)?Rt(e):0),e),hl=(e,t)=>Wt(((e,t)=>N(at(ee,e),(l=>Qe(l,t)?xt(e,l,t):0))),e,t),ml=()=>Wt((()=>He({}))),gl=()=>Wt((()=>{$e({}),e=!1})),bl=()=>Wt((()=>{Ae({}),t=!1})),wl=(e,t)=>{if(-1!=n){fl();const l=e();return pl(t),l}},fl=()=>(-1!=n&&n++,1==n&&Te(ve,void 0,Gt,Kt),Cl),pl=e=>(n>0&&(n--,0==n&&(l=!Xe(S),a=!Xe(z),n=1,Bt(1),l&&jt(1),Dt(1),a&&Ut(1),e?.(Gt,Kt)&&(_e(S,((e,t)=>_e(e,((e,l)=>_e(e,(([e],a)=>fe(Cl,t,l,a,e))))))),_e(z,(([e],t)=>pe(Cl,t,e))),l=a=!1),Te(Ie[0],void 0,Gt,Kt),n=-1,Bt(0),l&&jt(0),Dt(0),a&&Ut(0),Te(Ie[1],void 0,Gt,Kt),n=0,l=a=!1,q([o,i,c,T,V,S,F,R,z,O],Ze))),Cl),Cl={getContent:()=>[Qt(),ll()],getTables:Qt,getTableIds:Xt,getTable:e=>dt(at(ee,k(e))),getTableCellIds:e=>lt(at(_,k(e))),getRowCount:Yt,getRowIds:Zt,getSortedRowIds:_t,getRow:(e,t)=>it(at(at(ee,k(e)),k(t))),getCellIds:el,getCell:tl,getValues:ll,getValueIds:al,getValue:sl,hasTables:()=>!Xe(ee),hasTable:e=>Qe(ee,k(e)),hasTableCell:(e,t)=>Qe(at(_,k(e)),k(t)),hasRow:(e,t)=>Qe(at(ee,k(e)),k(t)),hasCell:(e,t,l)=>Qe(at(at(ee,k(e)),k(t)),k(l)),hasValues:()=>!Xe(te),hasValue:e=>Qe(te,k(e)),getTablesJson:()=>Q(ee),getValuesJson:()=>Q(te),getJson:()=>Q([ee,te]),getTablesSchemaJson:()=>Q(P),getValuesSchemaJson:()=>Q(H),getSchemaJson:()=>Q([P,H]),setContent:([e,t])=>Wt((()=>{(K(e)?ul:nl)(e),(K(t)?ml:ol)(t)})),setTables:nl,setTable:(e,t)=>Wt((e=>Re(t,e)?Fe(e,t):0),e),setRow:(e,t,l)=>Wt(((e,t)=>xe(e,t,l)?Oe(e,ft(e),t,l):0),e,t),addRow:(e,t,l=!0)=>wl((()=>{let a;return xe(e,a,t)&&(e=k(e),Oe(e,ft(e),a=Ye(e,l?1:0),t)),a})),setPartialRow:(e,t,l)=>Wt(((e,t)=>{if(xe(e,t,l,1)){const a=ft(e);G(l,((l,s)=>Be(e,a,t,s,l)))}}),e,t),setCell:(e,t,l,a)=>Wt(((e,t,l)=>N(Ne(e,t,l,L(a)?a(tl(e,t,l)):a),(a=>Be(e,ft(e),t,l,a)))),e,t,l),setValues:ol,setPartialValues:e=>Wt((()=>Ee(e,1)?G(e,((e,t)=>je(t,e))):0)),setValue:(e,t)=>Wt((e=>N(Le(e,L(t)?t(sl(e)):t),(t=>je(e,t)))),e),setTransactionChanges:e=>Wt((()=>{G(e[0],((e,t)=>x(e)?cl(t):G(e,((e,l)=>x(e)?hl(t,l):G(e,((e,a)=>fe(Cl,t,l,a,e))))))),G(e[1],((e,t)=>pe(Cl,t,e)))})),setTablesJson:rl,setValuesJson:e=>{try{De(X(e))}catch{}return Cl},setJson:e=>{try{const[t,l]=X(e);Je(t),De(l)}catch{rl(e)}return Cl},setTablesSchema:il,setValuesSchema:dl,setSchema:(e,t)=>Wt((()=>{il(e),dl(t)})),delTables:ul,delTable:cl,delRow:hl,delCell:(e,t,l,a)=>Wt(((e,t,l)=>N(at(ee,e),(s=>N(at(s,t),(n=>Qe(n,l)?Nt(e,s,t,n,l,a):0))))),e,t,l),delValues:ml,delValue:e=>Wt((e=>Qe(te,e)?Et(e):0),e),delTablesSchema:gl,delValuesSchema:bl,delSchema:()=>Wt((()=>{gl(),bl()})),transaction:wl,startTransaction:fl,finishTransaction:pl,forEachTable:e=>_e(ee,((t,l)=>e(l,(e=>_e(t,((t,l)=>e(l,(e=>st(t,e))))))))),forEachTableCell:(e,t)=>st(at(_,k(e)),t),forEachRow:(e,t)=>_e(at(ee,k(e)),((e,l)=>t(l,(t=>st(e,t))))),forEachCell:(e,t,l)=>st(at(at(ee,k(e)),k(t)),l),forEachValue:e=>st(te,e),addSortedRowIdsListener:(e,t,l,a,s,n,o)=>{let r=_t(e,t,l,a,s);return ye((()=>{const o=_t(e,t,l,a,s);var i,d,u;d=r,A(i=o)===A(d)&&(u=(e,t)=>d[t]===e,i.every(u))||(r=o,n(Cl,e,t,l,a,s,r))}),ie[o?1:0],[e,t],[Xt])},addStartTransactionListener:e=>ye(e,ve),addWillFinishTransactionListener:e=>ye(e,Ie[0]),addDidFinishTransactionListener:e=>ye(e,Ie[1]),callListener:e=>(ke(e),Cl),delListener:e=>(Ve(e),Cl),getListenerStats:()=>({tables:vt(le),tableIds:vt(ae),tableCellIds:vt(ne),table:vt(se),rowCount:vt(oe),rowIds:vt(re),sortedRowIds:vt(ie),row:vt(de,Ge),cellIds:vt(ue,Ge),cell:vt(ce,Ke),invalidCell:vt(he,Ke),values:vt(ge),valueIds:vt(be),value:vt(Ce),invalidValue:vt(me),transaction:We(ve)+vt(Ie)}),createStore:St};return G({[m]:[0,le],[g]:[0,ae],[h]:[1,se,[Xt]],[h+C]:[1,ne,[Xt]],[w]:[1,oe,[Xt]],[f]:[1,re,[Xt]],[b]:[2,de,[Xt,Zt]],[C]:[2,ue,[Xt,Zt]],[p]:[3,ce,[Xt,Zt,el],e=>Ct(tl(...e))],InvalidCell:[3,he],[I]:[0,ge],[y]:[0,be],[v]:[1,Ce,[al],e=>Ct(sl(e[0]))],InvalidValue:[1,me]},(([e,t,l,a],s)=>{Cl["add"+s+"Listener"]=(...s)=>ye(s[e],t[s[e+1]?1:0],e>0?J(s,0,e):void 0,l,a)})),D(Cl)},Rt=({position:e="right",open:a=!1})=>{const s=t.useCreateStore(St),n=_.indexOf(e);return t.useCreatePersister(s,(e=>He(e,Y)),void 0,(async e=>{await e.load(void 0,{position:-1==n?1:n,open:!!a}),await e.startAutoSave()})),me(l.Fragment,null,me("aside",{id:Y},me(be,{s:s}),me(Pe,{s:s})),me("style",null,he))};e.EditableCellView=Le,e.EditableValueView=ze,e.ResultSortedTableInHtmlTable=({queryId:e,cellId:l,descending:a,offset:s,limit:n,queries:o,sortOnClick:r,paginator:i=!1,onChange:d,...u})=>{const[c,h,m]=ke(l,a,r,s,n,t.useResultRowCount(e,o),i,d);return me(Re,{...u,params:Ie((()=>[{queryId:e,queries:o},[e,o],t.ResultCellView,t.useResultTableCellIds,c,h,m]),[e,o,c,h,m]),rowIds:t.useResultSortedRowIds(e,...c,n,o)})},e.ResultTableInHtmlTable=({queryId:e,queries:l,...a})=>me(Re,{...a,params:Ie((()=>[{queryId:e,queries:l},[e,l],t.ResultCellView,t.useResultTableCellIds]),[e,l]),rowIds:t.useResultRowIds(e,l)}),e.SortedTableInHtmlTable=Ne,e.SortedTablePaginator=qe,e.StoreInspector=e=>me(Rt,{...e}),e.TableInHtmlTable=({tableId:e,store:l,editable:a,...s})=>me(Re,{...s,params:Ie((()=>[{tableId:e,store:l},[e,l],a?Le:t.CellView,t.useTableCellIds]),[l,e,a]),rowIds:t.useRowIds(e,l)}),e.ValuesInHtmlTable=Ee},"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("./ui-react"),require("react")):"function"==typeof define&&define.amd?define(["exports","./ui-react","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseUiReactDomDebug={},e.TinyBaseUiReact,e.React);
