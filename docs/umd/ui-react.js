var e,s;e=this,s=function(e,s){"use strict";const t=e=>typeof e,o="",u=t(o),r="Listener",l="Result",d="Has",n="has",i="Ids",a="Table",c=a+"s",I=a+i,C="Row",b=C+"Count",p=C+i,w="Sorted"+C+i,R="Cell",k=R+i,g="Value",L=g+"s",h=g+i,m=e=>null==e,y=(e,s,t)=>m(e)?t?.():s(e),T=e=>t(e)==u,V=()=>{},S=(e,s)=>e.map(s),f=Object.keys,{createContext:x,useContext:v}=s,P=x([]),q=(e,s)=>{const t=v(P);return m(e)?t[s]:T(e)?((e,s)=>y(e,(e=>e[s])))(t[s+1]??{},e):e},B=(e,s)=>{const t=q(e,s);return m(e)||T(e)?t:e},H=e=>f(v(P)[e]??{}),M=e=>B(e,0),D=e=>B(e,2),F=e=>B(e,4),O=e=>B(e,6),Q=e=>B(e,8),E=e=>B(e,10),A=e=>e.toLowerCase();A(r);const G="Transaction";A(G);const{useCallback:j,useEffect:U,useMemo:W,useLayoutEffect:z,useRef:J,useState:K}=s,N=[],X={},Y=[[],void 0,[]],Z=(e,s,t=N)=>{const o=W((()=>s(e)),[e,...t]);return U((()=>()=>o.destroy()),[o]),o},$=(e,s,t,o=N,u,r="get",l="")=>{const[,d]=K(),n=j((()=>s?.[r+e]?.(...o)??t),[s,e,...o,t]),i=J();return W((()=>i.current=n()),[n]),_(l+e,s,((...e)=>{i.current=m(u)?n():e[u],d([])}),[n,u],o),i.current},_=(e,s,t,o=N,u=N,...l)=>z((()=>{const o=s?.["add"+e+r]?.(...u,t,...l);return()=>s?.delListener(o)}),[s,e,...u,...o,...l]),ee=(e,s,t,o=N,u=V,r=N,...l)=>{const d=M(e);return j((e=>y(d,(o=>y(t(e,o),(e=>u(o["set"+s](...l,e),e)))))),[d,s,...o,...r,...l])},se=(e,s,t=V,o=N,...u)=>{const r=M(e);return j((()=>t(r?.["del"+s](...u))),[r,s,...o,...u])},te=(e,s,t)=>{const o=E(e);return j((()=>o?.[s](t)),[o,s,t])},oe=e=>$(I,M(e),N),ue=(e,s)=>$(p,M(s),N,[e]),re=(e,s,t,o=0,u,r)=>$(w,M(r),N,[e,s,t,o,u],6),le=(e,s,t)=>$(k,M(t),N,[e,s]),de=(e,s,t,o)=>$(R,M(o),void 0,[e,s,t],4),ne=e=>$(h,M(e),N),ie=(e,s)=>$(g,M(s),void 0,[e]),ae=(e,s)=>$("Metric",D(s),void 0,[e]),ce=(e,s)=>$("SliceIds",F(s),N,[e]),Ie=(e,s,t)=>$("Slice"+p,F(t),N,[e,s]),Ce=(e,s,t)=>$("RemoteRowId",O(t),void 0,[e,s]),be=(e,s,t)=>$("Local"+p,O(t),N,[e,s]),pe=(e,s,t)=>$("Linked"+p,O(t),N,[e,s]),we=(e,s)=>$(l+p,Q(s),N,[e]),Re=(e,s,t,o=0,u,r)=>$(l+w,Q(r),N,[e,s,t,o,u],6),ke=(e,s,t)=>$(l+k,Q(t),N,[e,s]),ge=(e,s,t,o)=>$(l+R,Q(o),void 0,[e,s,t]),Le=e=>$("CheckpointIds",E(e),Y),he=(e,s)=>$("Checkpoint",E(s),void 0,[e]),me=e=>te(e,"goBackward"),ye=e=>te(e,"goForward"),{PureComponent:Te,Fragment:Ve,createElement:Se,useCallback:fe,useLayoutEffect:xe,useRef:ve,useState:Pe}=s,qe=(e,...s)=>m(e)?{}:e(...s),Be=(e,s)=>[e,e?.getStore(),e?.getLocalTableId(s),e?.getRemoteTableId(s)],{useMemo:He}=s,Me=({tableId:e,store:s,rowComponent:t=Ae,getRowComponentProps:o,customCellIds:u,separator:r,debugIds:l},d)=>Qe(S(d,(r=>Se(t,{...qe(o,r),key:r,tableId:e,rowId:r,customCellIds:u,store:s,debugIds:l}))),r,l,e),De=({queryId:e,queries:s,resultRowComponent:t=ze,getResultRowComponentProps:o,separator:u,debugIds:r},l)=>Qe(S(l,(u=>Se(t,{...qe(o,u),key:u,queryId:e,rowId:u,queries:s,debugIds:r}))),u,r,e),Fe=({relationshipId:e,relationships:s,rowComponent:t=Ae,getRowComponentProps:o,separator:u,debugIds:r},l,d)=>{const[n,i,a]=Be(O(s),e),c=l(e,d,n);return Qe(S(c,(e=>Se(t,{...qe(o,e),key:e,tableId:a,rowId:e,store:i,debugIds:r}))),u,r,d)},Oe=e=>({checkpoints:s,checkpointComponent:t=Je,getCheckpointComponentProps:o,separator:u,debugIds:r})=>{const l=E(s);return Qe(S(e(Le(l)),(e=>Se(t,{...qe(o,e),key:e,checkpoints:l,checkpointId:e,debugIds:r}))),u)},Qe=(e,s,t,o)=>{const u=m(s)||!Array.isArray(e)?e:S(e,((e,t)=>t>0?[s,e]:e));return t?[o,":{",u,"}"]:u},Ee=({tableId:e,rowId:s,cellId:t,store:u,debugIds:r})=>Qe(o+(de(e,s,t,u)??o),void 0,r,t),Ae=({tableId:e,rowId:s,store:t,cellComponent:o=Ee,getCellComponentProps:u,customCellIds:r,separator:l,debugIds:d})=>Qe(S(((e,s,t,o)=>{const u=le(s,t,o);return e??u})(r,e,s,t),(r=>Se(o,{...qe(u,r),key:r,tableId:e,rowId:s,cellId:r,store:t,debugIds:d}))),l,d,s),Ge=e=>Me(e,ue(e.tableId,e.store)),je=({valueId:e,store:s,debugIds:t})=>Qe(o+(ie(e,s)??o),void 0,t,e),Ue=({indexId:e,sliceId:s,indexes:t,rowComponent:o=Ae,getRowComponentProps:u,separator:r,debugIds:l})=>{const[d,n,i]=((e,s)=>[e,e?.getStore(),e?.getTableId(s)])(F(t),e),a=Ie(e,s,d);return Qe(S(a,(e=>Se(o,{...qe(u,e),key:e,tableId:i,rowId:e,store:n,debugIds:l}))),r,l,s)},We=({queryId:e,rowId:s,cellId:t,queries:u,debugIds:r})=>Qe(o+(ge(e,s,t,u)??o),void 0,r,t),ze=({queryId:e,rowId:s,queries:t,resultCellComponent:o=We,getResultCellComponentProps:u,separator:r,debugIds:l})=>Qe(S(ke(e,s,t),(r=>Se(o,{...qe(u,r),key:r,queryId:e,rowId:s,cellId:r,queries:t,debugIds:l}))),r,l,s),Je=({checkpoints:e,checkpointId:s,debugIds:t})=>Qe(he(s,e)??o,void 0,t,s),Ke=Oe((e=>e[0])),Ne=Oe((e=>m(e[1])?[]:[e[1]])),Xe=Oe((e=>e[2]));e.BackwardCheckpointsView=Ke,e.CellView=Ee,e.CheckpointView=Je,e.CurrentCheckpointView=Ne,e.ForwardCheckpointsView=Xe,e.IndexView=({indexId:e,indexes:s,sliceComponent:t=Ue,getSliceComponentProps:o,separator:u,debugIds:r})=>Qe(S(ce(e,s),(u=>Se(t,{...qe(o,u),key:u,indexId:e,sliceId:u,indexes:s,debugIds:r}))),u,r,e),e.LinkedRowsView=e=>Fe(e,pe,e.firstRowId),e.LocalRowsView=e=>Fe(e,be,e.remoteRowId),e.MetricView=({metricId:e,metrics:s,debugIds:t})=>Qe(ae(e,s)??o,void 0,t,e),e.Provider=({store:e,storesById:t,metrics:o,metricsById:u,indexes:r,indexesById:l,relationships:d,relationshipsById:n,queries:i,queriesById:a,checkpoints:c,checkpointsById:I,children:C})=>{const b=s.useContext(P);return Se(P.Provider,{value:He((()=>[e??b[0],{...b[1],...t},o??b[2],{...b[3],...u},r??b[4],{...b[5],...l},d??b[6],{...b[7],...n},i??b[8],{...b[9],...a},c??b[10],{...b[11],...I}]),[e,t,o,u,r,l,d,n,i,a,c,I,b])},C)},e.RemoteRowView=({relationshipId:e,localRowId:s,relationships:t,rowComponent:o=Ae,getRowComponentProps:u,debugIds:r})=>{const[l,d,,n]=Be(O(t),e),i=Ce(e,s,l);return Qe(m(n)||m(i)?null:Se(o,{...qe(u,i),key:i,tableId:n,rowId:i,store:d,debugIds:r}),void 0,r,s)},e.ResultCellView=We,e.ResultRowView=ze,e.ResultSortedTableView=({cellId:e,descending:s,offset:t,limit:o,...u})=>De(u,Re(u.queryId,e,s,t,o,u.queries)),e.ResultTableView=e=>De(e,we(e.queryId,e.queries)),e.RowView=Ae,e.SliceView=Ue,e.SortedTableView=({cellId:e,descending:s,offset:t,limit:o,...u})=>Me(u,re(u.tableId,e,s,t,o,u.store)),e.TableView=Ge,e.TablesView=({store:e,tableComponent:s=Ge,getTableComponentProps:t,separator:o,debugIds:u})=>Qe(S(oe(e),(o=>Se(s,{...qe(t,o),key:o,tableId:o,store:e,debugIds:u}))),o),e.ValueView=je,e.ValuesView=({store:e,valueComponent:s=je,getValueComponentProps:t,separator:o,debugIds:u})=>Qe(S(ne(e),(o=>Se(s,{...qe(t,o),key:o,valueId:o,store:e,debugIds:u}))),o),e.useAddRowCallback=(e,s,t=N,o,u=V,r=N,l=!0)=>{const d=M(o);return j((t=>y(d,(o=>y(s(t,o),(s=>u(o.addRow(e,s,l),o,s)))))),[d,e,...t,...r,l])},e.useCell=de,e.useCellIds=le,e.useCellIdsListener=(e,s,t,o,u,r)=>_(k,M(r),t,o,[e,s],u),e.useCellListener=(e,s,t,o,u,r,l)=>_(R,M(l),o,u,[e,s,t],r),e.useCheckpoint=he,e.useCheckpointIds=Le,e.useCheckpointIdsListener=(e,s,t)=>_("CheckpointIds",E(t),e,s),e.useCheckpointListener=(e,s,t,o)=>_("Checkpoint",E(o),s,t,[e]),e.useCheckpoints=e=>q(e,10),e.useCheckpointsIds=()=>H(11),e.useCheckpointsOrCheckpointsById=E,e.useCreateCheckpoints=(e,s,t)=>Z(e,s,t),e.useCreateIndexes=(e,s,t)=>Z(e,s,t),e.useCreateMetrics=(e,s,t)=>Z(e,s,t),e.useCreatePersister=(e,s,t=N,o,u=N,r,l=N)=>{const[,d]=K(),n=W((()=>s(e)),[e,...t]);return U((()=>((async()=>{o&&(await o(n),d([]))})(),()=>{n?.destroy(),r?.(n)})),[n,...u,...l]),n},e.useCreateQueries=(e,s,t)=>Z(e,s,t),e.useCreateRelationships=(e,s,t)=>Z(e,s,t),e.useCreateStore=(e,s=N)=>W(e,s),e.useDelCellCallback=(e,s,t,o,u,r,l)=>se(u,R,r,l,e,s,t,o),e.useDelRowCallback=(e,s,t,o,u)=>se(t,C,o,u,e,s),e.useDelTableCallback=(e,s,t,o)=>se(s,a,t,o,e),e.useDelTablesCallback=(e,s,t)=>se(e,c,s,t),e.useDelValueCallback=(e,s,t,o)=>se(s,g,t,o,e),e.useDelValuesCallback=(e,s,t)=>se(e,L,s,t),e.useDidFinishTransactionListener=(e,s,t)=>_("DidFinish"+G,M(t),e,s),e.useGoBackwardCallback=me,e.useGoForwardCallback=ye,e.useGoToCallback=(e,s=N,t,o=V,u=N)=>{const r=E(t);return j((s=>y(r,(t=>y(e(s),(e=>o(t.goTo(e),e)))))),[r,...s,...u])},e.useHasCell=(e,s,t,o)=>$(R,M(o),!1,[e,s,t],4,n,d),e.useHasCellListener=(e,s,t,o,u,r,l)=>_(d+R,M(l),o,u,[e,s,t],r),e.useHasRow=(e,s,t)=>$(C,M(t),!1,[e,s],3,n,d),e.useHasRowListener=(e,s,t,o,u,r)=>_(d+C,M(r),t,o,[e,s],u),e.useHasTable=(e,s)=>$(a,M(s),!1,[e],2,n,d),e.useHasTableCell=(e,s,t)=>$(a+R,M(t),!1,[e,s],3,n,d),e.useHasTableCellListener=(e,s,t,o,u,r)=>_(d+a+R,M(r),t,o,[e,s],u),e.useHasTableListener=(e,s,t,o,u)=>_(d+a,M(u),s,t,[e],o),e.useHasTables=e=>$(c,M(e),!1,[],1,n,d),e.useHasTablesListener=(e,s,t,o)=>_(d+c,M(o),e,s,[],t),e.useHasValue=(e,s)=>$(g,M(s),!1,[e],2,n,d),e.useHasValueListener=(e,s,t,o,u)=>_(d+g,M(u),s,t,[e],o),e.useHasValues=e=>$(L,M(e),!1,[],1,n,d),e.useHasValuesListener=(e,s,t,o)=>_(d+L,M(o),e,s,[],t),e.useIndexIds=e=>$("IndexIds",F(e),N),e.useIndexes=e=>q(e,4),e.useIndexesIds=()=>H(5),e.useIndexesOrIndexesById=F,e.useLinkedRowIds=pe,e.useLinkedRowIdsListener=(e,s,t,o,u)=>_("Linked"+p,O(u),t,o,[e,s]),e.useLocalRowIds=be,e.useLocalRowIdsListener=(e,s,t,o,u)=>_("Local"+p,O(u),t,o,[e,s]),e.useMetric=ae,e.useMetricIds=e=>$("MetricIds",D(e),N),e.useMetricListener=(e,s,t,o)=>_("Metric",D(o),s,t,[e]),e.useMetrics=e=>q(e,2),e.useMetricsIds=()=>H(3),e.useMetricsOrMetricsById=D,e.useQueries=e=>q(e,8),e.useQueriesIds=()=>H(9),e.useQueriesOrQueriesById=Q,e.useQueryIds=e=>$("QueryIds",Q(e),N),e.useRedoInformation=e=>{const s=E(e),[,,[t]]=Le(s);return[!m(t),ye(s),t,y(t,(e=>s?.getCheckpoint(e)))??o]},e.useRelationshipIds=e=>$("RelationshipIds",O(e),N),e.useRelationships=e=>q(e,6),e.useRelationshipsIds=()=>H(7),e.useRelationshipsOrRelationshipsById=O,e.useRemoteRowId=Ce,e.useRemoteRowIdListener=(e,s,t,o,u)=>_("RemoteRowId",O(u),t,o,[e,s]),e.useResultCell=ge,e.useResultCellIds=ke,e.useResultCellIdsListener=(e,s,t,o,u)=>_(l+k,Q(u),t,o,[e,s]),e.useResultCellListener=(e,s,t,o,u,r)=>_(l+R,Q(r),o,u,[e,s,t]),e.useResultRow=(e,s,t)=>$(l+C,Q(t),X,[e,s]),e.useResultRowCount=(e,s)=>$(l+b,Q(s),0,[e]),e.useResultRowCountListener=(e,s,t,o)=>_(l+b,Q(o),s,t,[e]),e.useResultRowIds=we,e.useResultRowIdsListener=(e,s,t,o)=>_(l+p,Q(o),s,t,[e]),e.useResultRowListener=(e,s,t,o,u)=>_(l+C,Q(u),t,o,[e,s]),e.useResultSortedRowIds=Re,e.useResultSortedRowIdsListener=(e,s,t,o,u,r,d,n)=>_(l+w,Q(n),r,d,[e,s,t,o,u]),e.useResultTable=(e,s)=>$(l+a,Q(s),X,[e]),e.useResultTableCellIds=(e,s)=>$(l+a+k,Q(s),N,[e]),e.useResultTableCellIdsListener=(e,s,t,o)=>_(l+a+k,Q(o),s,t,[e]),e.useResultTableListener=(e,s,t,o)=>_(l+a,Q(o),s,t,[e]),e.useRow=(e,s,t)=>$(C,M(t),X,[e,s]),e.useRowCount=(e,s)=>$(b,M(s),0,[e]),e.useRowCountListener=(e,s,t,o,u)=>_(b,M(u),s,t,[e],o),e.useRowIds=ue,e.useRowIdsListener=(e,s,t,o,u)=>_(p,M(u),s,t,[e],o),e.useRowListener=(e,s,t,o,u,r)=>_(C,M(r),t,o,[e,s],u),e.useSetCellCallback=(e,s,t,o,u,r,l,d)=>ee(r,R,o,u,l,d,e,s,t),e.useSetCheckpointCallback=(e=V,s=N,t,o=V,u=N)=>{const r=E(t);return j((s=>y(r,(t=>{const u=e(s);o(t.addCheckpoint(u),t,u)}))),[r,...s,...u])},e.useSetPartialRowCallback=(e,s,t,o,u,r,l)=>ee(u,"PartialRow",t,o,r,l,e,s),e.useSetPartialValuesCallback=(e,s,t,o,u)=>ee(t,"PartialValues",e,s,o,u),e.useSetRowCallback=(e,s,t,o,u,r,l)=>ee(u,C,t,o,r,l,e,s),e.useSetTableCallback=(e,s,t,o,u,r)=>ee(o,a,s,t,u,r,e),e.useSetTablesCallback=(e,s,t,o,u)=>ee(t,c,e,s,o,u),e.useSetValueCallback=(e,s,t,o,u,r)=>ee(o,g,s,t,u,r,e),e.useSetValuesCallback=(e,s,t,o,u)=>ee(t,L,e,s,o,u),e.useSliceIds=ce,e.useSliceIdsListener=(e,s,t,o)=>_("SliceIds",F(o),s,t,[e]),e.useSliceRowIds=Ie,e.useSliceRowIdsListener=(e,s,t,o,u)=>_("Slice"+p,F(u),t,o,[e,s]),e.useSortedRowIds=re,e.useSortedRowIdsListener=(e,s,t,o,u,r,l,d,n)=>_(w,M(n),r,l,[e,s,t,o,u],d),e.useStartTransactionListener=(e,s,t)=>_("Start"+G,M(t),e,s),e.useStore=e=>q(e,0),e.useStoreIds=()=>H(1),e.useStoreOrStoreById=M,e.useTable=(e,s)=>$(a,M(s),X,[e]),e.useTableCellIds=(e,s)=>$(a+k,M(s),N,[e]),e.useTableCellIdsListener=(e,s,t,o,u)=>_(a+k,M(u),s,t,[e],o),e.useTableIds=oe,e.useTableIdsListener=(e,s,t,o)=>_(I,M(o),e,s,N,t),e.useTableListener=(e,s,t,o,u)=>_(a,M(u),s,t,[e],o),e.useTables=e=>$(c,M(e),X),e.useTablesListener=(e,s,t,o)=>_(c,M(o),e,s,N,t),e.useUndoInformation=e=>{const s=E(e),[t,u]=Le(s);return[(r=t,!(0==r.length)),me(s),u,y(u,(e=>s?.getCheckpoint(e)))??o];var r},e.useValue=ie,e.useValueIds=ne,e.useValueIdsListener=(e,s,t,o)=>_(h,M(o),e,s,N,t),e.useValueListener=(e,s,t,o,u)=>_(g,M(u),s,t,[e],o),e.useValues=e=>$(L,M(e),X),e.useValuesListener=(e,s,t,o)=>_(L,M(o),e,s,N,t),e.useWillFinishTransactionListener=(e,s,t)=>_("WillFinish"+G,M(t),e,s)},"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],s):s((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseUiReact={},e.React);
