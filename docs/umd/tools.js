var e,t;e=this,t=function(e){"use strict";const t=e=>typeof e,l="tinybase",a="",n=",",o=t(a),d=t(!0),s=t(0),r="type",I="default",c="Listener",$="get",i="add",u="Ids",p="Table",b=p+"s",C=p+u,h="Row",m=h+u,g="Sorted"+h+u,f="Cell",w=f+u,y="Value",T=y+"s",v=y+u,V=Promise,x=isFinite,R=e=>null==e,k=(e,t,l)=>R(e)?l?.():t(e),S=e=>e==o||e==d,P=e=>t(e)==o,A=e=>Array.isArray(e),E=(e,t,l)=>e.slice(t,l),O=e=>e.length,D=async e=>V.all(e),N=e=>{const l=t(e);return S(l)||l==s&&x(e)?l:void 0},G=(e,t)=>e.every(t),L=(e,t)=>e.sort(t),j=(e,t)=>e.forEach(t),M=(e,t=a)=>e.join(t),J=(e,t)=>e.map(t),z=(e,t)=>e.filter(t),W=(e,...t)=>e.push(...t),B=e=>e.pop(),F=(e,...t)=>e.unshift(...t),U=e=>e.shift(),_=Object,Z=e=>_.getPrototypeOf(e),H=_.keys,Q=_.freeze,q=e=>!R(e)&&k(Z(e),(e=>e==_.prototype||R(Z(e))),(()=>!0)),K=(e,t)=>J(_.entries(e),(([e,l])=>t(l,e))),X=e=>O(H(e)),Y=e=>q(e)&&0==X(e),ee=(e,t)=>e?.has(t)??!1,te=e=>[...e?.values()??[]],le=(e,t)=>e?.forEach(t),ae=(e,t)=>e?.delete(t),ne=e=>new Map(e),oe=(e,t)=>e?.get(t),de=(e,t)=>le(e,((e,l)=>t(l,e))),se=(e,t)=>J([...e?.entries()??[]],(([e,l])=>t(l,e))),re=(e,t,l)=>R(l)?(ae(e,t),e):e?.set(t,l),Ie=(e,t,l)=>(ee(e,t)||re(e,t,l()),oe(e,t)),ce=e=>e.toUpperCase(),$e=e=>e.toLowerCase(),ie="a ",ue="A function for",pe=", and registers a listener so that any changes to that result will cause a re-render",be="Callback",Ce="Del",he="Deps",me=he+"?: React.DependencyList",ge="doRollback?: DoRollback",fe="actions: () => Return, "+ge,we="export",ye="Id",Te="Invalid",ve="Json",Ve=$e(c),xe="?: ",Re=" | undefined",ke="NonNullable",Se="Partial",Pe="Props",Ae="Provider",Ee=`Registers a ${Ve} that will be called`,Oe="Represents",De="rowId: "+ye,Ne="Schema",Ge="Set",Le=", descending?: boolean, offset?: number, limit?: number",je="[]",Me="the Store",Je="Transaction",ze=Je+"Changes",We=$e(Je),Be="Execute a "+We+" to make multiple mutations",Fe="Explicitly starts a "+We,Ue="Explicitly finishes a "+We,_e="the end of the "+We,Ze="void",He=" => "+Ze,Qe="WhenSet",qe=" when setting it",Ke=ie+"string serialization of",Xe=" ",Ye="Gets a callback that can ",et="the ",tt=" the schema for",lt=(e=0,t=0)=>`the ${ft[e]}content of`+(t?Xe+Me:a),at=(e=0,t,l=0)=>ht[t]+Xe+lt(e,1)+(l?" when setting it":a),nt=(e,t=0)=>Oe+` a Row when ${t?"s":"g"}etting ${lt()} the '${e}' `+p,ot=(e,t,l=0)=>`Gets ${l?"sorted, paginated":"the"} Ids of the ${e}s in `+t,dt=(e,t)=>`Calls a function for each ${e} in `+t,st=e=>"The props passed to a component that renders "+e,rt=e=>"A function that takes "+e,It=(e,t=0)=>ue+" listening to changes to "+gt[e]+" in "+gt[t],ct=(e,t,l=0)=>Ee+" whenever "+gt[e]+" in "+gt[t]+" change"+(l?a:"s"),$t=e=>`the '${e}' `+p,it=e=>"the specified Row in "+$t(e),ut=(e,t=0)=>ht[t]+` ${lt()} `+$t(e),pt=(e,t=0)=>ht[t]+` ${lt()} `+it(e),bt=(e,t,l=0)=>ht[l]+` the '${t}' Cell for `+it(e),Ct=(e,t=0)=>ht[t]+` the '${e}' Value`,ht=["Gets","Checks existence of","Sets","Deletes","Sets part of",Oe,"Gets "+Ke,"Sets "+Ke,Ee+" whenever",Ye+"set",Ye+"add",Ye+"set part of",Ye+"delete","Renders","Gets "+Ke+tt,"Sets"+tt,"Deletes"+tt],mt=[$,"has","set","del","set","forEach",i,a],gt=[Me,b,et+p+Xe+u,ie+p,et+h+Xe+u,ie+h,et+f+Xe+u,ie+f,"invalid Cell changes",T,et+y+Xe+u,ie+y,"invalid Value changes",et+"sorted "+h+Xe+u,et+f+Xe+u+" anywhere",et+"number of Rows"],ft=[a,"tabular ","keyed value "],wt=e=>new Set(A(e)||R(e)?e:[e]),yt=(e,t)=>e?.add(t),Tt=/[^A-Za-z]+/,vt=/[^A-Za-z0-9]+/,Vt=/^( *)\/\*\* *(.*?) *\*\/$/gm,xt=e=>e.includes(n),Rt=(e,t,l,a=1)=>{const n=`${t}${1==a?"":a}`;return ee(e,n)?Rt(e,t,l,a+1):(re(e,n,l),n)},kt=e=>e.replace(Vt,((e,t,l)=>{const a=77-O(t);return`${t}/**\n${l.replace(RegExp(`([^\\n]{1,${a}})(\\s|$)`,"g"),t+" * $1\n")}${t} */`})),St=e=>e.flat(1e3),Pt=(e,t=0)=>M(J(e.split(vt),((e,l)=>(l>0||t?ce:$e)(E(e,0,1))+E(e,1)))),At=e=>ce(M((e&&!Tt.test(e[0])?e:" "+e).split(vt),"_")),Et=e=>`/** ${e}. */`,Ot=(...e)=>M(z(e,(e=>e)),", "),Dt=(...e)=>"{"+M(e,"; ")+"}",Nt=(...e)=>Dt(...J(e,(e=>"readonly "+e))),Gt=()=>{const e=[ne(),ne(),ne(),ne()],t=ne(),l=ne(),n=e=>{const t=e.indexOf(" as ");return-1!=t?E(e,t+4):e};return[(...e)=>M(St(e),"\n"),(t,l,...a)=>j(a,(a=>j([0,1],(n=>(t??n)==n?yt(Ie(e[n],l,wt),a):0)))),(e,l,n,o=a,d=1)=>Rt(t,e,[l,n,o,d]),(e,t,a)=>Rt(l,e,A(a)?[`(${t}) => {`,a,"}"]:[`(${t}) => ${a}`]),(e,t)=>oe(l,e)===t?e:Rt(l,e,t),(t=0)=>J([...L(se(e[t],((e,t)=>`import {${M(L(te(e),((e,t)=>n(e)>n(t)?1:-1)),", ")}} from '${t}';`)),((e,t)=>xt(e)!=xt(t)?xt(e)?-1:1:e>t?1:-1)),a],(e=>e.replace("{React}","React"))),()=>se(t,(([e,t,l,n],o)=>[Et(t),`${n?we+" ":a}type ${o}${l} = ${e};`,a])),()=>se(l,((e,t)=>(e=A(e)?e:[e],W(e,B(e)+";"),[`const ${t} = ${U(e)}`,e,a])))]},Lt=e=>{const t=new WeakMap;return l=>(t.has(l)||t.set(l,e(l)),t.get(l))},jt=(e,t,l)=>[t=>K(e,((e,a)=>t(a,Pt(a,1),l(At(a),`'${a}'`)))),(t,a)=>K(e[t],((e,t)=>a(t,e[r],e[I],l(At(t),`'${t}'`),Pt(t,1)))),e=>K(t,((t,a)=>e(a,t[r],t[I],l(At(a),`'${a}'`),Pt(a,1))))],Mt=(e,t,l,n)=>[(n,o)=>{const d=n+": "+o,s=e(b,Dt(...t((e=>`'${e}'?: {[rowId: Id]: `+Dt(...l(e,((e,t,l)=>`'${e}'${R(l)?"?":a}: ${t}`)))+"}"))),at(1,5)),r=e(b+Qe,Dt(...t((e=>`'${e}'?: {[rowId: Id]: `+Dt(...l(e,((e,t)=>`'${e}'?: ${t}`)))+"}"))),at(1,5,1)),I=e(p+ye,"keyof "+s,"A "+p+" Id in "+Me),$=`<TId extends ${I}>`,i=e(p,ke+`<${s}[TId]>`,"A "+p+" in "+Me,$),u=e(p+Qe,ke+`<${r}[TId]>`,"A "+p+" in "+Me+qe,$),y=e(h,i+"<TId>[Id]","A "+h+" in a "+p,$),T=e(h+Qe,u+"<TId>[Id]","A "+h+" in a "+p+qe,$),v=e(f+ye,`Extract<keyof ${y}<TId>, Id>`,"A "+f+" Id in a "+h,$),V=e(f,ke+`<${s}[TId]>[Id][CId]`,"A "+f+" in a "+h,`<TId extends ${I}, CId extends ${v}<TId>>`),x=e("CellIdCellArray",`CId extends ${v}<TId> ? [cellId: CId, cell: ${V}<TId, CId>] : never`,f+" Ids and types in a "+h,`<TId extends ${I}, CId = ${v}<TId>>`,0),k=e(f+be,`(...[cellId, cell]: ${x}<TId>)`+He,rt(ie+f+" Id, and "+f),$),S=e(h+be,"(rowId: Id, forEachCell: (cellCallback: CellCallback<TId>) "+He+") "+He,rt(ie+h+" Id, and a "+f+" iterator"),$),P=e(p+f+be,`(cellId: ${v}<TId>, count: number) `+He,rt(ie+f+" Id, and count of how many times it appears"),$),A=e("TableIdForEachRowArray",`TId extends ${I} ? [tableId: TId, forEachRow: (rowCallback: ${S}<TId>)${He}] : never`,p+" Ids and callback types",`<TId = ${I}>`,0),E=e(p+be,`(...[tableId, forEachRow]: ${A})`+He,rt(ie+p+" Id, and a "+h+" iterator"),a),O=e("TableIdRowIdCellIdArray",`TId extends ${I} ? [tableId: TId, rowId: Id, cellId: ${v}<TId>] : never`,"Ids for GetCellChange",`<TId = ${I}>`,0),D=e("GetCellChange",`(...[tableId, rowId, cellId]: ${O}) => CellChange`,ue+" returning information about any Cell's changes during a "+We),N=e(b+c,`(${d}, getCellChange: ${D}${Re})`+He,It(1)),G=e(C+c,`(${d})`+He,It(2)),L=e(p+c,`(${d}, tableId: ${I}, getCellChange: ${D}${Re})`+He,It(3)),j=e(p+w+c,`(${d}, tableId: ${I})`+He,It(14,3)),M=e(h+"Count"+c,`(${d}, tableId: ${I})`+He,It(15,3)),J=e(m+c,`(${d}, tableId: ${I})`+He,It(4,3)),z=e(g+c,"("+Ot(d,"tableId: "+I,"cellId: Id"+Re,"descending: boolean","offset: number","limit: number"+Re,"sortedRowIds: Ids")+")"+He,It(13,3)),W=e(h+c,"("+Ot(""+d,"tableId: "+I,De,`getCellChange: ${D}${Re}`)+")"+He,It(5,3)),B=e(w+c,"("+Ot(""+d,"tableId: "+I,De)+")"+He,It(6,5)),F=e("CellListenerArgsArrayInner",`CId extends ${v}<TId> ? [${d}, tableId: TId, ${De}, cellId: CId, newCell: ${V}<TId, CId> ${Re}, oldCell: ${V}<TId, CId> ${Re}, getCellChange: ${D} ${Re}] : never`,"Cell args for CellListener",`<TId extends ${I}, CId = ${v}<TId>>`,0),U=e("CellListenerArgsArrayOuter",`TId extends ${I} ? `+F+"<TId> : never","Table args for CellListener",`<TId = ${I}>`,0);return[s,r,I,i,u,y,T,v,V,k,S,P,E,N,G,L,j,M,J,z,W,B,e(f+c,`(...[${n}, tableId, rowId, cellId, newCell, oldCell, getCellChange]: ${U})`+He,It(7,5)),e(Te+f+c,`(${d}, tableId: Id, ${De}, cellId: Id, invalidCells: any[])`+He,It(8))]},(t,l)=>{const o=t+": "+l,d=e(T,Dt(...n(((e,t,l)=>`'${e}'${R(l)?"?":a}: ${t}`))),at(2,5)),s=e(T+Qe,Dt(...n(((e,t)=>`'${e}'?: ${t}`))),at(2,5,1)),r=e(y+ye,"keyof "+d,"A "+y+" Id in "+Me),I=e(y,ke+`<${d}[VId]>`,"A "+y+" Id in "+Me,`<VId extends ${r}>`),$=e("ValueIdValueArray",`VId extends ${r} ? [valueId: VId, value: ${I}<VId>] : never`,y+" Ids and types in "+Me,`<VId = ${r}>`,0),i=e(y+be,`(...[valueId, value]: ${$})`+He,rt(ie+y+" Id, and "+y)),u=e("GetValueChange",`(valueId: ${r}) => ValueChange`,ue+" returning information about any Value's changes during a "+We),p=e(T+c,`(${o}, getValueChange: ${u}${Re})`+He,It(9)),b=e(v+c,`(${o})`+He,It(10)),C=e("ValueListenerArgsArray",`VId extends ${r} ? [${o}, valueId: VId, newValue: ${I}<VId> ${Re}, oldValue: ${I}<VId> ${Re}, getValueChange: ${u} ${Re}] : never`,"Value args for ValueListener",`<VId = ${r}>`,0);return[d,s,r,I,i,p,b,e(y+c,`(...[${t}, valueId, newValue, oldValue, getValueChange]: `+C+")"+He,It(11)),e(Te+y+c,`(${o}, valueId: Id, invalidValues: any[])`+He,It(12))]},(t,l)=>e(Je+c,`(${t}: ${l}, getTransactionChanges: GetTransactionChanges, getTransactionLog: GetTransactionLog)`+He,ue+" listening to the completion of a "+We)],Jt=(e,t=a,l=a)=>`store.${e}(${t})`+(l?" as "+l:a),zt=(e,t=a)=>`fluent(() => ${Jt(e,t)})`,Wt=(e,t=a,l=a)=>`store.${e}(${t?t+", ":a}proxy(listener)${l?", "+l:a})`,Bt=(e,t,n)=>{const[o,s,$,V,x,k,S,A]=Gt(),[E,O,D]=jt(e,t,x),[N,G,L]=Mt($,E,O,D),J=ne(),z=(e=0)=>se(J,(([t,l,n,o,d],s)=>{const r=e?[s+`: ${d}(${t}): ${l} => ${n},`]:[s+d+`(${t}): ${l};`];return e||F(r,Et(o)),W(r,a),r})),B=(e,t,l,n,o,d=a)=>Rt(J,e,[t,l,n,o,d]),U=(e,t,l,n,o,d=a,s=a,r=a)=>B(mt[e]+t+(4==e?Se:a)+l,d,n,(n==H?zt:Jt)(mt[e]+(4==e?Se:a)+l,s,e?void 0:n),o,r),_=(e,t,l,n=a,o=a,d=1,s=a)=>B(i+e+c,(n?n+", ":a)+Ve+": "+t+(d?", mutator?: boolean":a),ye,Wt(i+e+c,o,d?"mutator":a),l,s),Z=`./${Pt(n)}.d`,H=Pt(n,1),Q=Pt(H),q=[],K=ne();let X=[],ee=[];if(s(1,Z,H,`create${H} as create${H}Decl`),Y(e))s(null,l,b);else{s(0,l,"CellChange"),s(null,l,u);const[e,t,n,o,c,i,y,T,v,V,k,S,A,D,G,L,J,z,B,F,Y,ee,le,ae]=N(Q,H),de=ne();E(((e,t)=>{const l=`<'${e}'>`,a=[$(t+p,o+l,Oe+` the '${e}' `+p),$(t+p+Qe,c+l,Oe+` the '${e}' `+p+qe),$(t+h,i+l,nt(e)),$(t+h+Qe,y+l,nt(e,1)),$(t+f+ye,T+l,`A Cell Id for the '${e}' `+p),$(t+f+be,V+l,rt(`a Cell Id and value from a Row in the '${e}' `+p)),$(t+h+be,k+l,rt(`a Row Id from the '${e}' Table, and a Cell iterator`)),$(t+p+f+be,S+l,rt(`a Cell Id from anywhere in the '${e}' Table, and a count of how many times it appears`))];re(de,e,a),s(1,Z,...a)})),s(1,Z,e,t,n,T,A,D,G,L,J,z,B,F,Y,ee,le,ae),X=[e,t,n,T,D,G,L,J,z,B,F,Y,ee,le,de],j([[e],[d],[H,"tables: "+t,"tables"],[H]],(([e,t,l],n)=>U(n,a,b,e,at(1,n),t,l))),U(0,a,C,n+je,ot(p,Me)),U(5,a,p,Ze,dt(p,Me),"tableCallback: "+A,"tableCallback as any"),E(((e,t,l)=>{const[n,o,s,r,I,c,$,i]=oe(de,e);j([[n],[d],[H,"table: "+o,", table"],[H]],(([n,o,d=a],s)=>U(s,t,p,n,ut(e,s),o,l+d))),U(0,t,p+w,u,ot(f,"the whole of "+$t(e)),a,l),U(5,t,p+f,Ze,dt(p+f,"the whole of "+$t(e)),"tableCellCallback: "+i,l+", tableCellCallback as any"),U(0,t,h+"Count","number","Gets the number of Rows in the "+$t(e),a,l),U(0,t,m,u,ot(h,$t(e)),a,l),U(0,t,g,u,ot(h,$t(e),1),"cellId?: "+I+Le,l+", cellId, descending, offset, limit"),U(5,t,h,Ze,dt(h,$t(e)),"rowCallback: "+$,l+", rowCallback as any"),j([[s],[d],[H,", row: "+r,", row"],[H],[H,", partialRow: "+r,", partialRow"]],(([n,o=a,d=a],s)=>U(s,t,h,n,pt(e,s),De+o,l+", rowId"+d))),U(6,t,h,ye+Re,"Add a new Row to "+$t(e),"row: "+r+", reuseIds?: boolean",l+", row, reuseIds"),U(0,t,w,I+je,ot(f,it(e)),De,l+", rowId"),U(5,t,f,Ze,dt(f,it(e)),De+", cellCallback: "+c,l+", rowId, cellCallback as any"),O(e,((n,o,s,r,I)=>{const c="Map"+Pt(o,1);re(K,o,c);const $=o+(R(s)?Re:a);j([[$],[d],[H,`, cell: ${o} | `+c,", cell as any"],[H]],(([o,d=a,s=a],c)=>U(c,t+I,f,o,bt(e,n,c),De+d,l+", rowId, "+r+s))),U(1,t+I,p+f,d,ht[1]+` the '${n}' Cell anywhere in `+$t(e),a,l+", "+r)}))})),U(0,a,b+ve,ve,at(1,6)),U(2,a,b+ve,H,at(1,7),"tablesJson: "+ve,"tables"+ve),_(b,D,at(1,8)+" changes"),_(C,G,ct(2,0,1)),_(p,L,ct(3,0),`tableId: ${n} | null`,"tableId"),_(p+w,J,ct(14,3,1),`tableId: ${n} | null`,"tableId"),_(h+"Count",z,ct(15,3),`tableId: ${n} | null`,"tableId"),_(m,B,ct(4,3,1),`tableId: ${n} | null`,"tableId"),_(g,F,ct(13,3,1),Ot("tableId: TId",`cellId: ${T}<TId>`+Re,"descending: boolean","offset: number","limit: number"+Re),Ot("tableId","cellId","descending","offset","limit"),1,"<TId extends TableId>"),_(h,Y,ct(5,3),`tableId: ${n} | null, rowId: IdOrNull`,"tableId, rowId"),_(w,ee,ct(6,5,1),`tableId: ${n} | null, rowId: IdOrNull`,"tableId, rowId"),_(f,le,ct(7,5),`tableId: ${n} | null, rowId: IdOrNull, cellId: ${M(E((e=>oe(de,e)?.[4]??a))," | ")} | null`,"tableId, rowId, cellId"),_(Te+f,ae,Ee+" whenever an invalid Cell change was attempted","tableId: IdOrNull, rowId: IdOrNull, cellId: IdOrNull","tableId, rowId, cellId"),s(1,Z,...te(K)),W(q,".set"+b+Ne+"({",St(E(((e,t,l)=>[`[${l}]: {`,...O(e,((e,t,l,n)=>`[${n}]: {[${x(At(r),`'${r}'`)}]: ${x(At(t),`'${t}'`)}${R(l)?a:`, [${x(At(I),`'${I}'`)}]: `+(P(l)?x(At(l),`'${l}'`):l)}},`)),"},"]))),"})")}if(Y(t))s(null,l,T);else{const[e,t,n,o,c,$,i,u,p]=G(Q,H);s(1,Z,e,t,n,c,$,i,u,p),ee=[e,t,n,$,i,u],j([[e],[d],[H,"values: "+t,"values"],[H],[H,"partialValues: "+t,"partialValues"]],(([e,t,l],n)=>U(n,a,T,e,at(2,n),t,l))),U(0,a,v,n+je,ot(y,Me)),U(5,a,y,"void",dt(y,Me),"valueCallback: "+c,"valueCallback as any"),D(((e,t,l,n,o)=>{const s="Map"+Pt(t,1);re(K,t,s),j([[t],[d],[H,`value: ${t} | `+s,", value as any"],[H]],(([t,l,d=a],s)=>U(s,o,y,t,Ct(e,s),l,n+d)))})),U(0,a,T+ve,ve,at(2,6)),U(2,a,T+ve,H,at(2,7),"valuesJson: "+ve,"values"+ve),_(T,$,at(2,8)+" changes"),_(v,i,ct(10,0,1)),_(y,u,ct(11,0),`valueId: ${n} | null`,"valueId"),_(Te+y,p,Ee+" whenever an invalid Value change was attempted","valueId: IdOrNull","valueId"),s(1,Z,...te(K)),s(0,l,"ValueChange"),W(q,".set"+T+Ne+"({",D(((e,t,l,n)=>[`[${n}]: {[${x(At(r),`'${r}'`)}]: ${x(At(t),`'${t}'`)}${R(l)?a:`, [${x(At(I),`'${I}'`)}]: `+(P(l)?x(At(l),`'${l}'`):l)}},`])),"})")}U(0,a,"Content",`[${b}, ${T}]`,at(0,0)),U(2,a,"Content",H,at(0,2),`[tables, values]: [${b}, ${T}]`,"[tables, values]"),U(2,a,ze,H,`Applies a set of ${ze} to the Store`,"transactionChanges: "+ze,"transactionChanges"),de(K,((e,t)=>$(t,`(cell: ${e}${Re}) => `+e,`Takes a ${e} Cell value and returns another`))),s(null,l,"DoRollback",ye,"IdOrNull",ve,"Store",ze),s(0,l,"Get"+ze,"GetTransactionLog"),U(0,a,ve,ve,at(0,6)),U(2,a,ve,H,at(0,7),"tablesAndValuesJson: "+ve,"tablesAndValuesJson"),U(7,a,We,"Return",Be,fe,"actions, doRollback","<Return>"),U(7,a,"start"+Je,H,Fe),U(7,a,"finish"+Je,H,Ue,ge,"doRollback");const le=L(Q,H);return _("Start"+Je,le,Ee+" just before the start of the "+We,a,a,0),_("WillFinish"+Je,le,Ee+" just before "+_e,a,a,0),_("DidFinish"+Je,le,Ee+" just after "+_e,a,a,0),U(7,a,"call"+c,H,"Manually provoke a listener to be called","listenerId: Id","listenerId"),U(3,a,c,H,"Remove a listener that was previously added to "+Me,"listenerId: Id","listenerId"),B("getStore",a,"Store","store",ht[0]+" the underlying Store object"),s(1,l,"createStore"),s(1,Z,H,`create${H} as create${H}Decl`,le),x("store",["createStore()",...q]),V("fluent","actions: () => Store",["actions();",`return ${Q};`]),V("proxy","listener: any",`(_: Store, ...params: any[]) => listener(${Q}, ...params)`),x(Q,["{",...z(1),"}"]),[o(...k(0),...S(),we+" interface "+H+" {",...z(0),"}",a,Et(`Creates a ${H} object`),we+" function create"+H+"(): "+H+";"),o(...k(1),we+" const create"+H+": typeof create"+H+"Decl = () => {",...A(),`return Object.freeze(${Q});`,"};"),X,ee]},Ft=e=>$+e,Ut=e=>Ot(Ft(e),Ft(e)+he),_t="debugIds?: boolean",Zt="debugIds={debugIds}",Ht="then"+me,Qt="Parameter",qt=": (parameter: "+Qt+", store: Store) => ",Kt="const contextValue = useContext(Context);",Xt=", based on a parameter",Yt=": ",el="<"+Qt+",>",tl=Qt+"ized"+be+"<"+Qt+">",ll="rowId",al="rowId={rowId}",nl=", separator, debugIds",ol="separator?: ReactElement | string",dl="then?: (store: Store",sl=Ot(dl+")"+He,Ht),rl="then, then"+he,Il=ll+Yt+ye,cl="View",$l=(e,...t)=>Ot(...t,Ve+": "+e,Ve+me,"mutator?: boolean"),il=(...e)=>Ot(...e,Ve,Ve+he,"mutator"),ul=(e,t,n,o,d)=>{const[s,r,I,$,i,V,x,k]=Gt(),[S,P,A]=jt(e,t,i),E=`./${Pt(n)}.d`,O=`./${Pt(n)}-ui-react.d`,D="tinybase/ui-react",N=Pt(n,1),G=Pt(N),L=N+"Or"+N+ye,j=G+"Or"+N+ye,J=G+`={${G}}`,z=ne(),B=(e,t,l,n,o,d=a)=>(r(1,O,e+" as "+e+"Decl"),Rt(z,e,[t,l,n,o,d])),U=(e,t,l,n,o,d=a)=>B("use"+e,t,l,n,o,d),_=(e,t,l,n,o=a,d=a,s=a,I=a,c=a)=>(r(1,D,`use${t} as use${t}Core`),U(e,Ot(o,K,I),l,ee+`(${j}, use${t}Core, [`+(d||a)+(c?"], ["+c:a)+"]);",n,s)),Z=(e,t,l,a)=>B(e,t,1,l,a),H=(e=0)=>se(z,(([t,l,n,o,d],s)=>{const r=e?[we+` const ${s}: typeof ${s}Decl = ${d}(${t}): ${1==l?"any":l} =>`,n]:[we+` function ${s}${d}(${t}): ${1==l?"ComponentReturnType":l};`];return e||F(r,Et(o)),W(r,a),r}));r(null,l,ye,"Store",be,Qt+"ized"+be),r(0,D,"ComponentReturnType"),r(1,D,"useCellIds"),r(null,D,"ExtraProps"),r(0,E,N);const Q=I(L,N+" | "+ye,`Used when you need to refer to a ${N} in a React hook or component`),q=I(Ae+Pe,Nt(G+xe+N,G+`ById?: {[${G}Id: Id]: ${N}}`),`Used with the ${Ae} component, so that a `+N+" can be passed into the context of an application");r(0,"react","ReactElement","ComponentType"),r(1,"react","React"),r(1,O,Q,q);const K=j+xe+Q;i("{createContext, useContext, useMemo}","React"),i("Context",`createContext<[${N}?, {[${G}Id: Id]: ${N}}?]>([])`),U("Create"+N,`create: () => ${N}, create`+me,N,"\n// eslint-disable-next-line react-hooks/exhaustive-deps\nuseMemo(create, createDeps)",`Create a ${N} within a React application with convenient memoization`);const X=U(N,"id?: Id",N+Re,["{",Kt,"return id == null ? contextValue[0] : contextValue[1]?.[id];","}"],`Get a reference to a ${N} from within a ${Ae} component context`),ee=$("useHook",j+`: ${Q} | undefined, hook: (...params: any[]) => any, preParams: any[], postParams: any[] = []`,[`const ${G} = ${X}(${j} as Id);`,`return hook(...preParams, ((${j} == null || typeof ${j} == 'string')`,`? ${G} : ${j})?.getStore(), ...postParams)`]),te=$("getProps","getProps: ((id: any) => ExtraProps) | undefined, id: Id","(getProps == null) ? ({} as ExtraProps) : getProps(id)"),le=$("wrap",Ot("children: any","separator?: any","encloseWithId?: boolean","id?: Id"),["const separated = separator==null || !Array.isArray(children)"," ? children"," : children.map((child, c) => (c > 0 ? [separator, child] : child));","return encloseWithId ? [id, ':{', separated, '}'] : separated;"]),ae=$("useCustomOrDefaultCellIds",Ot("customCellIds: Ids | undefined","tableId: Id","rowId: Id",`${j}?: ${Q} | undefined`),[`const defaultCellIds = ${ee}(${j}, useCellIds, [tableId, rowId]);`,"return customCellIds ?? defaultCellIds;"]),de=i("NullComponent","() => null");if(!Y(e)){const[e,t,n,d,s,i,y,T,v,V,x,k,A,D,L]=o;r(null,E,e,t,n,s,i,y,T,v,V,x,k,A,D),r(0,E,d),r(1,E,N),r(null,l,u,"IdOrNull");const j=$("tableView",`{${G}, rowComponent, getRowComponentProps, customCellIds`+nl+"}: any, rowIds: Ids, tableId: Id, defaultRowComponent: React.ComponentType<any>",["const Row = rowComponent ?? defaultRowComponent;",`return ${le}(rowIds.map((rowId) => (`,"<Row","{..."+te+"(getRowComponentProps, rowId)}","key={rowId}","tableId={tableId}",al,"customCellIds={customCellIds}",J,Zt,"/>","))",nl,", tableId,",");"]),z=$("getDefaultTableComponent","tableId: Id",M(S(((e,t,l)=>`tableId == ${l} ? ${t}TableView : `)))+de),W=$("getDefaultCellComponent","tableId: Id, cellId: Id",M(S(((e,t,l)=>`tableId == ${l} ? ${M(P(e,((e,l,a,n,o)=>`cellId == ${n} ? `+t+o+"CellView : ")))+de} : `)))+de);_(b,b,e,at(1,0)+pe);const B=_(C,C,n+je,ot(p,Me)+pe);_(Ge+b+be,Ge+b+be,tl,at(1,9)+Xt,Ot(Ft(b)+qt+t,Ft(b)+me),Ut(b),el,Ot(dl,`tables: ${t})`+He,Ht),rl),_(Ce+b+be,Ce+b+be,be,at(1,12),a,a,a,sl,rl);const F=I(f+Pe,Nt("tableId?: TId","rowId: Id","cellId?: CId",G+xe+N,_t),st(ie+f),`<TId extends ${n}, CId extends ${d}<TId>>`),U=I(h+Pe,Nt("tableId?: TId","rowId: Id",G+xe+N,"cellComponents?: {readonly [CId in "+d+`<TId>]?: ComponentType<${F}<TId, CId>>;}`,`getCellComponentProps?: (cellId: ${d}<TId>) => ExtraProps`,`customCellIds?: ${d}<TId>[]`,ol,_t),st(ie+h),`<TId extends ${n}>`),H=I(p+Pe,Nt("tableId?: TId",G+xe+N,`rowComponent?: ComponentType<${U}<TId>>`,"getRowComponentProps?: (rowId: Id) => ExtraProps","customCellIds?: CellId<TId>[]",ol,_t),st(ie+p),`<TId extends ${n}>`),Q=I("Sorted"+p+Pe,Nt("tableId?: TId","cellId?: "+d+"<TId>","descending?: boolean","offset?: number","limit?: number",G+xe+N,`rowComponent?: ComponentType<${U}<TId>>`,"getRowComponentProps?: (rowId: Id) => ExtraProps","customCellIds?: CellId<TId>[]",ol,_t),st(ie+"sorted "+p),`<TId extends ${n}>`),q=I(b+Pe,Nt(G+xe+N,"tableComponents?: {readonly [TId in "+n+`]?: ComponentType<${H}<TId>>;}`,`getTableComponentProps?: (tableId: ${n}) => ExtraProps`,ol,_t),st(lt(1,1)));r(1,O,q,H,Q,U,F),Z(b+cl,"{"+G+", tableComponents, getTableComponentProps"+nl+"}: "+q,[le+`(${B}(${G}).map((tableId) => {`,"const Table = (tableComponents?.[tableId] ?? "+z+"(tableId)) as React.ComponentType<TableProps<typeof tableId>>;","return <Table",`{...${te}(getTableComponentProps, tableId)}`,"tableId={tableId}","key={tableId}",J,Zt,"/>;","}), separator)"],at(1,13)+pe),S(((e,t,l)=>{const[n,o,d,s,I]=oe(L,e);r(null,E,n,o,d,s,I),_(t+p,p,n,ut(e)+pe,a,l),_(t+p+w,p+w,u,ot(f,"the whole of "+$t(e))+pe,a,l);const c=_(t+m,m,u,ot(h,$t(e))+pe,a,l),$=_(t+g,g,u,ot(h,$t(e),1)+pe,"cellId?: "+I+", descending?: boolean, offset?: number, limit?: number",l+", cellId, descending, offset, limit");_(t+h,h,d,pt(e)+pe,Il,Ot(l,ll)),_(t+w,w,I+je,ot(f,it(e))+pe,Il,Ot(l,ll)),_(Ge+t+p+be,Ge+p+be,tl,ut(e,9)+Xt,Ot(Ft(p)+qt+o,Ft(p)+me),Ot(l,Ut(p)),el,Ot(dl,`table: ${o})`+He,Ht),rl),_(Ce+t+p+be,Ce+p+be,be,ut(e,12),a,l,a,sl,rl),_(Ge+t+h+be,Ge+h+be,tl,pt(e,9)+Xt,Ot(Il,Ft(h)+qt+s,Ft(h)+me),Ot(l,ll,Ut(h)),el,Ot(dl,`row: ${s})`+He,Ht),rl),_("Add"+t+h+be,"Add"+h+be,tl,pt(e,10)+Xt,Ot(Ft(h)+qt+s,Ft(h)+me),Ot(l,Ut(h)),el,"then?: ("+Ot(Il+Re,"store: Store","row: "+s+")"+He,"then"+me)+", reuseRowIds?: boolean",rl+", reuseRowIds"),_(Ge+t+Se+h+be,Ge+Se+h+be,tl,pt(e,11)+Xt,Ot(Il,Ft(Se+h)+qt+s,Ft(Se+h)+me),Ot(l,ll,Ut(Se+h)),el,Ot(dl,`partialRow: ${s})`+He,Ht),rl),_(Ce+t+h+be,Ce+h+be,be,pt(e,12),Il,Ot(l,ll),a,sl,rl);const i=Z(t+h+cl,"{rowId, "+G+", cellComponents, getCellComponentProps, customCellIds"+nl+`}: ${U}<'${e}'>`,[le+`(${ae}(customCellIds, `+l+`, rowId, ${G}).map((cellId: ${I}) => {`,"const Cell = (cellComponents?.[cellId] ?? "+W+`(${l}, cellId)) as React.ComponentType<CellProps<typeof `+l+", typeof cellId>>;","return <Cell",`{...${te}(getCellComponentProps, cellId)} `,"key={cellId}",`tableId={${l}}`,al,"cellId={cellId}",J,Zt,"/>;","})"+nl+", rowId)"],pt(e,13)+pe);Z(t+"Sorted"+p+cl,"{cellId, descending, offset, limit, ...props}: "+Q+`<'${e}'>`,j+"(props, "+$+`(cellId, descending, offset, limit, props.${G}), ${l}, ${i});`,ut(e,13)+", sorted"+pe),Z(t+p+cl,`props: ${H}<'${e}'>`,j+"(props, "+c+`(props.${G}), ${l}, ${i});`,ut(e,13)+pe),P(e,((n,o,d,s,I)=>{const c="Map"+Pt(o,1);r(0,E,c),r(1,E,c);const $=_(t+I+f,f,o+(R(d)?Re:a),bt(e,n)+pe,Il,Ot(l,ll,s));_(Ge+t+I+f+be,Ge+f+be,tl,bt(e,n,9)+Xt,Ot(Il,Ft(f)+qt+o+" | "+c,Ft(f)+me),Ot(l,ll,s,Ut(f)),el,Ot(dl,`cell: ${o} | ${c})`+He,Ht),rl),_(Ce+t+I+f+be,Ce+f+be,be,bt(e,n,12),Ot(Il,"forceDel?: boolean"),Ot(l,ll,s,"forceDel"),a,sl,rl),Z(t+I+f+cl,`{rowId, ${G}, debugIds}: `+F+`<'${e}', '${n}'>`,[le+`('' + ${$}(rowId, `+G+`) ?? '', undefined, debugIds, ${s})`],bt(e,n,13)+pe)}))}));const K=M(S((e=>oe(L,e)?.[4]??a))," | ");_(b+c,b+c,Ze,at(1,8)+" changes",$l(s),il()),_(C+c,C+c,Ze,ct(2,0,1),$l(i),il()),_(p+c,p+c,Ze,ct(3,0),$l(y,`tableId: ${n} | null`),il("tableId")),_(p+w+c,p+w+c,Ze,ct(14,3,1),$l(T,`tableId: ${n} | null`),il("tableId")),_(m+c,m+c,Ze,ct(4,3,1),$l(V,`tableId: ${n} | null`),il("tableId")),_(g+c,g+c,Ze,ct(13,3,1),$l(x,`tableId: ${n} | null`,"cellId: "+K+Re,"descending: boolean","offset: number","limit: number"+Re),il("tableId","cellId","descending","offset","limit")),_(h+c,h+c,Ze,ct(5,3),$l(k,`tableId: ${n} | null`,ll+": IdOrNull"),il("tableId",ll)),_(w+c,w+c,Ze,ct(6,5,1),$l(A,`tableId: ${n} | null`,ll+": IdOrNull"),il("tableId",ll)),_(f+c,f+c,Ze,ct(7,5),$l(D,`tableId: ${n} | null`,ll+": IdOrNull",`cellId: ${K} | null`),il("tableId",ll,"cellId"))}if(!Y(t)){const[e,t,l,n,o,s]=d;r(null,E,...d),r(1,E,N);const i=$("getDefaultValueComponent","valueId: Id",M(A(((e,t,l,a,n)=>`valueId == ${a} ? `+n+"ValueView : ")))+de);_(T,T,e,at(2,0)+pe);const u=_(v,v,l+je,ot(y,Me)+pe);_(Ge+T+be,Ge+T+be,tl,at(2,9)+Xt,Ot(Ft(T)+qt+t,Ft(T)+me),Ut(T),el,Ot(dl,`values: ${t})`+He,Ht),rl),_(Ge+Se+T+be,Ge+Se+T+be,tl,at(2,11)+Xt,Ot(Ft(Se+T)+qt+t,Ft(Se+T)+me),Ut(Se+T),el,Ot(dl,`partialValues: ${t})`+He,Ht),rl),_(Ce+T+be,Ce+T+be,be,at(2,12),a,a,a,sl,rl);const p=I(y+Pe,Nt("valueId?: VId",G+xe+N,_t),st("a Value"),`<VId extends ${l}>`),b=I(T+Pe,Nt(G+xe+N,"valueComponents?: {readonly [VId in "+l+`]?: ComponentType<${p}<VId>>;}`,`getValueComponentProps?: (valueId: ${l}) => ExtraProps`,ol,_t),st(lt(2,1)));r(1,O,b,p),Z(T+cl,"{"+G+", valueComponents, getValueComponentProps"+nl+"}: "+b,[le+`(${u}(${G}).map((valueId) => {`,"const Value = valueComponents?.[valueId] ?? "+i+"(valueId);","return <Value",`{...${te}(getValueComponentProps, valueId)}`,"key={valueId}",J,Zt,"/>;","}), separator)"],at(2,13)+pe),A(((e,t,l,n,o)=>{const d="Map"+Pt(t,1);r(0,E,d),r(1,E,d);const s=_(o+y,y,t,Ct(e)+pe,a,n);_(Ge+o+y+be,Ge+y+be,tl,Ct(e,9)+Xt,Ot(Ft(y)+qt+t+" | "+d,Ft(y)+me),Ot(n,Ut(y)),el,Ot(dl,`value: ${t} | ${d})`+He,Ht),rl),_(Ce+o+y+be,Ce+y+be,be,Ct(e,12),a,n,a,sl,rl),Z(o+y+cl,`{${G}, debugIds}: ${p}<'${e}'>`,[le+`('' + ${s}(`+G+`) ?? '', undefined, debugIds, ${n})`],Ct(e,13)+pe)})),_(T+c,T+c,Ze,at(2,8)+" changes",$l(n),il()),_(v+c,v+c,Ze,ct(10,0,1),$l(o),il()),_(y+c,y+c,Ze,ct(11,0),$l(s,`valueId: ${l} | null`),il("valueId"))}return Z(Ae,`{${G}, ${G}ById, children}: `+q+" & {children: React.ReactNode}",["{",Kt,"return (","<Context."+Ae,"value={useMemo(",`() => [${G} ?? contextValue[0], {...contextValue[1], ...${G}ById}],`,`[${G}, ${G}ById, contextValue],`,")}>","{children}",`</Context.${Ae}>`,");","}"],"Wraps part of an application in a context that provides default objects to be used by hooks and components within"),[s(...V(0),...x(),...H(0)),s(...V(1),...k(),...H(1))]},pl=(e,t,l)=>{if(Y(e)&&Y(t))return[a,a,a,a];const[n,o,d,s]=Bt(e,t,l);return[n,o,...ul(e,t,l,d,s)]},bl=JSON.parse,Cl="prettier/",hl=Cl+"plugins/",ml={parser:"typescript",singleQuote:!0,trailingComma:"all",bracketSpacing:!1,jsdocSingleLineComment:!1},gl=Lt((e=>{const t=()=>{const t=bl(e.getTablesSchemaJson());return!Y(t)||G(e.getTableIds(),(l=>{const a=e.getRowIds(l),n=ne();if(G(a,(t=>G(e.getCellIds(l,t),(a=>{const o=e.getCell(l,t,a),d=Ie(n,a,(()=>[N(o),ne(),[0],0])),[s,r,[I]]=d,c=Ie(r,o,(()=>0))+1;return c>I&&(d[2]=[c,o]),re(r,o,c),d[3]++,s==N(o)})))))return t[l]={},le(n,(([e,,[,n],o],d)=>{t[l][d]={[r]:e,...o==O(a)?{[I]:n}:{}}})),1}))?t:{}},l=()=>{const t=bl(e.getValuesSchemaJson());return Y(t)&&e.forEachValue(((e,l)=>{t[e]={[r]:N(l)}})),t},a=e=>pl(t(),l(),e),n=async e=>{const t=["d.ts","ts","d.ts","tsx"],l=[];let n;try{n=(await import(Cl+"standalone")).format,W(l,await import(hl+"estree"),await import(hl+"typescript"))}catch(e){n=async e=>e}return await D(J(a(e),(async(e,a)=>kt(await n(e,{...ml,plugins:l,filepath:"_."+t[a]})))))};return Q({getStoreStats:t=>{let l=0,a=0,n=0;const o={};return e.forEachTable(((e,d)=>{l++;let s=0,r=0;const I={};d(((e,l)=>{s++;let a=0;l((()=>a++)),r+=a,t&&(I[e]={rowCells:a})})),a+=s,n+=r,t&&(o[e]={tableRows:s,tableCells:r,rows:I})})),{totalTables:l,totalRows:a,totalCells:n,totalValues:O(e.getValueIds()),jsonLength:O(e.getJson()),...t?{detail:{tables:o}}:{}}},getStoreTablesSchema:t,getStoreValuesSchema:l,getStoreApi:a,getPrettyStoreApi:n,getStore:()=>e})}));e.createTools=gl},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseTools={});
