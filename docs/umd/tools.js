var e,t;e=this,t=function(e){"use strict";const t=e=>typeof e,l="tinybase",a="",n=",",o=t(a),d=t(!0),s=t(0),r="type",I="default",c="Listener",$="get",i="add",u="Ids",p="Table",b=p+"s",C=p+u,h="Row",m=h+u,g="Sorted"+h+u,f="Cell",w=f+u,y="Value",T=y+"s",v=y+u,V=Promise,x=isFinite,R=(e,t)=>e instanceof t,k=e=>null==e,S=e=>e==o||e==d,P=e=>t(e)==o,A=e=>Array.isArray(e),E=(e,t,l)=>e.slice(t,l),D=e=>e.length,O=async e=>V.all(e),N=e=>{const l=t(e);return S(l)||l==s&&x(e)?l:void 0},G=(e,t)=>e.every(t),L=(e,t)=>e.sort(t),j=(e,t)=>e.forEach(t),M=(e,t=a)=>e.join(t),J=(e,t)=>e.map(t),z=(e,t)=>e.filter(t),W=(e,...t)=>e.push(...t),B=e=>e.pop(),F=(e,...t)=>e.unshift(...t),U=e=>e.shift(),_=Object,Z=_.keys,H=_.freeze,Q=e=>R(e,_)&&e.constructor==_,q=(e,t)=>J(_.entries(e),(([e,l])=>t(l,e))),K=e=>D(Z(e)),X=e=>Q(e)&&0==K(e),Y=(e,t)=>e?.has(t)??!1,ee=e=>[...e?.values()??[]],te=(e,t)=>e?.forEach(t),le=(e,t)=>e?.delete(t),ae=e=>new Map(e),ne=(e,t)=>e?.get(t),oe=(e,t)=>te(e,((e,l)=>t(l,e))),de=(e,t)=>J([...e?.entries()??[]],(([e,l])=>t(l,e))),se=(e,t,l)=>k(l)?(le(e,t),e):e?.set(t,l),re=(e,t,l)=>(Y(e,t)||se(e,t,l()),ne(e,t)),Ie=e=>e.toUpperCase(),ce=e=>e.toLowerCase(),$e="a ",ie="A function for",ue=", and registers a listener so that any changes to that result will cause a re-render",pe="Callback",be="Del",Ce="Deps",he=Ce+"?: React.DependencyList",me="doRollback?: DoRollback",ge="actions: () => Return, "+me,fe="export",we="Id",ye="Invalid",Te="Json",ve=ce(c),Ve="?: ",xe=" | undefined",Re="NonNullable",ke="Partial",Se="Props",Pe="Provider",Ae=`Registers a ${ve} that will be called`,Ee="Represents",De="rowId: "+we,Oe="Schema",Ne="Set",Ge=", descending?: boolean, offset?: number, limit?: number",Le="[]",je="the Store",Me="Transaction",Je=Me+"Changes",ze=ce(Me),We="Execute a "+ze+" to make multiple mutations",Be="Explicitly starts a "+ze,Fe="Explicitly finishes a "+ze,Ue="the end of the "+ze,_e="void",Ze=" => "+_e,He="WhenSet",Qe=" when setting it",qe=$e+"string serialization of",Ke=" ",Xe="Gets a callback that can ",Ye="the ",et=" the schema for",tt=(e=0,t=0)=>`the ${gt[e]}content of`+(t?Ke+je:a),lt=(e=0,t,l=0)=>Ct[t]+Ke+tt(e,1)+(l?" when setting it":a),at=(e,t=0)=>Ee+` a Row when ${t?"s":"g"}etting ${tt()} the '${e}' `+p,nt=(e,t,l=0)=>`Gets ${l?"sorted, paginated":"the"} Ids of the ${e}s in `+t,ot=(e,t)=>`Calls a function for each ${e} in `+t,dt=e=>"The props passed to a component that renders "+e,st=e=>"A function that takes "+e,rt=(e,t=0)=>ie+" listening to changes to "+mt[e]+" in "+mt[t],It=(e,t,l=0)=>Ae+" whenever "+mt[e]+" in "+mt[t]+" change"+(l?a:"s"),ct=e=>`the '${e}' `+p,$t=e=>"the specified Row in "+ct(e),it=(e,t=0)=>Ct[t]+` ${tt()} `+ct(e),ut=(e,t=0)=>Ct[t]+` ${tt()} `+$t(e),pt=(e,t,l=0)=>Ct[l]+` the '${t}' Cell for `+$t(e),bt=(e,t=0)=>Ct[t]+` the '${e}' Value`,Ct=["Gets","Checks existence of","Sets","Deletes","Sets part of",Ee,"Gets "+qe,"Sets "+qe,Ae+" whenever",Xe+"set",Xe+"add",Xe+"set part of",Xe+"delete","Renders","Gets "+qe+et,"Sets"+et,"Deletes"+et],ht=[$,"has","set","del","set","forEach",i,a],mt=[je,b,Ye+p+Ke+u,$e+p,Ye+h+Ke+u,$e+h,Ye+f+Ke+u,$e+f,"invalid Cell changes",T,Ye+y+Ke+u,$e+y,"invalid Value changes",Ye+"sorted "+h+Ke+u,Ye+f+Ke+u+" anywhere",Ye+"number of Rows"],gt=[a,"tabular ","keyed value "],ft=e=>new Set(A(e)||k(e)?e:[e]),wt=(e,t)=>e?.add(t),yt=/[^A-Za-z]+/,Tt=/[^A-Za-z0-9]+/,vt=/^( *)\/\*\* *(.*?) *\*\/$/gm,Vt=e=>e.includes(n),xt=(e,t,l,a=1)=>{const n=`${t}${1==a?"":a}`;return Y(e,n)?xt(e,t,l,a+1):(se(e,n,l),n)},Rt=e=>e.replace(vt,((e,t,l)=>{const a=77-D(t);return`${t}/**\n${l.replace(RegExp(`([^\\n]{1,${a}})(\\s|$)`,"g"),t+" * $1\n")}${t} */`})),kt=e=>e.flat(1e3),St=(e,t=0)=>M(J(e.split(Tt),((e,l)=>(l>0||t?Ie:ce)(E(e,0,1))+E(e,1)))),Pt=e=>Ie(M((e&&!yt.test(e[0])?e:" "+e).split(Tt),"_")),At=e=>`/** ${e}. */`,Et=(...e)=>M(z(e,(e=>e)),", "),Dt=(...e)=>"{"+M(e,"; ")+"}",Ot=(...e)=>Dt(...J(e,(e=>"readonly "+e))),Nt=()=>{const e=[ae(),ae(),ae(),ae()],t=ae(),l=ae(),n=e=>{const t=e.indexOf(" as ");return-1!=t?E(e,t+4):e};return[(...e)=>M(kt(e),"\n"),(t,l,...a)=>j(a,(a=>j([0,1],(n=>(t??n)==n?wt(re(e[n],l,ft),a):0)))),(e,l,n,o=a,d=1)=>xt(t,e,[l,n,o,d]),(e,t,a)=>xt(l,e,A(a)?[`(${t}) => {`,a,"}"]:[`(${t}) => ${a}`]),(e,t)=>ne(l,e)===t?e:xt(l,e,t),(t=0)=>J([...L(de(e[t],((e,t)=>`import {${M(L(ee(e),((e,t)=>n(e)>n(t)?1:-1)),", ")}} from '${t}';`)),((e,t)=>Vt(e)!=Vt(t)?Vt(e)?-1:1:e>t?1:-1)),a],(e=>e.replace("{React}","React"))),()=>de(t,(([e,t,l,n],o)=>[At(t),`${n?fe+" ":a}type ${o}${l} = ${e};`,a])),()=>de(l,((e,t)=>(e=A(e)?e:[e],W(e,B(e)+";"),[`const ${t} = ${U(e)}`,e,a])))]},Gt=e=>{const t=new WeakMap;return l=>(t.has(l)||t.set(l,e(l)),t.get(l))},Lt=(e,t,l)=>[t=>q(e,((e,a)=>t(a,St(a,1),l(Pt(a),`'${a}'`)))),(t,a)=>q(e[t],((e,t)=>a(t,e[r],e[I],l(Pt(t),`'${t}'`),St(t,1)))),e=>q(t,((t,a)=>e(a,t[r],t[I],l(Pt(a),`'${a}'`),St(a,1))))],jt=(e,t,l,n)=>[(n,o)=>{const d=n+": "+o,s=e(b,Dt(...t((e=>`'${e}'?: {[rowId: Id]: `+Dt(...l(e,((e,t,l)=>`'${e}'${k(l)?"?":a}: ${t}`)))+"}"))),lt(1,5)),r=e(b+He,Dt(...t((e=>`'${e}'?: {[rowId: Id]: `+Dt(...l(e,((e,t)=>`'${e}'?: ${t}`)))+"}"))),lt(1,5,1)),I=e(p+we,"keyof "+s,"A "+p+" Id in "+je),$=`<TId extends ${I}>`,i=e(p,Re+`<${s}[TId]>`,"A "+p+" in "+je,$),u=e(p+He,Re+`<${r}[TId]>`,"A "+p+" in "+je+Qe,$),y=e(h,i+"<TId>[Id]","A "+h+" in a "+p,$),T=e(h+He,u+"<TId>[Id]","A "+h+" in a "+p+Qe,$),v=e(f+we,`Extract<keyof ${y}<TId>, Id>`,"A "+f+" Id in a "+h,$),V=e(f,Re+`<${s}[TId]>[Id][CId]`,"A "+f+" in a "+h,`<TId extends ${I}, CId extends ${v}<TId>>`),x=e("CellIdCellArray",`CId extends ${v}<TId> ? [cellId: CId, cell: ${V}<TId, CId>] : never`,f+" Ids and types in a "+h,`<TId extends ${I}, CId = ${v}<TId>>`,0),R=e(f+pe,`(...[cellId, cell]: ${x}<TId>)`+Ze,st($e+f+" Id, and "+f),$),S=e(h+pe,"(rowId: Id, forEachCell: (cellCallback: CellCallback<TId>) "+Ze+") "+Ze,st($e+h+" Id, and a "+f+" iterator"),$),P=e(p+f+pe,`(cellId: ${v}<TId>, count: number) `+Ze,st($e+f+" Id, and count of how many times it appears"),$),A=e("TableIdForEachRowArray",`TId extends ${I} ? [tableId: TId, forEachRow: (rowCallback: ${S}<TId>)${Ze}] : never`,p+" Ids and callback types",`<TId = ${I}>`,0),E=e(p+pe,`(...[tableId, forEachRow]: ${A})`+Ze,st($e+p+" Id, and a "+h+" iterator"),a),D=e("TableIdRowIdCellIdArray",`TId extends ${I} ? [tableId: TId, rowId: Id, cellId: ${v}<TId>] : never`,"Ids for GetCellChange",`<TId = ${I}>`,0),O=e("GetCellChange",`(...[tableId, rowId, cellId]: ${D}) => CellChange`,ie+" returning information about any Cell's changes during a "+ze),N=e(b+c,`(${d}, getCellChange: ${O}${xe})`+Ze,rt(1)),G=e(C+c,`(${d})`+Ze,rt(2)),L=e(p+c,`(${d}, tableId: ${I}, getCellChange: ${O}${xe})`+Ze,rt(3)),j=e(p+w+c,`(${d}, tableId: ${I})`+Ze,rt(14,3)),M=e(h+"Count"+c,`(${d}, tableId: ${I})`+Ze,rt(15,3)),J=e(m+c,`(${d}, tableId: ${I})`+Ze,rt(4,3)),z=e(g+c,"("+Et(d,"tableId: "+I,"cellId: Id"+xe,"descending: boolean","offset: number","limit: number"+xe,"sortedRowIds: Ids")+")"+Ze,rt(13,3)),W=e(h+c,"("+Et(""+d,"tableId: "+I,De,`getCellChange: ${O}${xe}`)+")"+Ze,rt(5,3)),B=e(w+c,"("+Et(""+d,"tableId: "+I,De)+")"+Ze,rt(6,5)),F=e("CellListenerArgsArrayInner",`CId extends ${v}<TId> ? [${d}, tableId: TId, ${De}, cellId: CId, newCell: ${V}<TId, CId> ${xe}, oldCell: ${V}<TId, CId> ${xe}, getCellChange: ${O} ${xe}] : never`,"Cell args for CellListener",`<TId extends ${I}, CId = ${v}<TId>>`,0),U=e("CellListenerArgsArrayOuter",`TId extends ${I} ? `+F+"<TId> : never","Table args for CellListener",`<TId = ${I}>`,0);return[s,r,I,i,u,y,T,v,V,R,S,P,E,N,G,L,j,M,J,z,W,B,e(f+c,`(...[${n}, tableId, rowId, cellId, newCell, oldCell, getCellChange]: ${U})`+Ze,rt(7,5)),e(ye+f+c,`(${d}, tableId: Id, ${De}, cellId: Id, invalidCells: any[])`+Ze,rt(8))]},(t,l)=>{const o=t+": "+l,d=e(T,Dt(...n(((e,t,l)=>`'${e}'${k(l)?"?":a}: ${t}`))),lt(2,5)),s=e(T+He,Dt(...n(((e,t)=>`'${e}'?: ${t}`))),lt(2,5,1)),r=e(y+we,"keyof "+d,"A "+y+" Id in "+je),I=e(y,Re+`<${d}[VId]>`,"A "+y+" Id in "+je,`<VId extends ${r}>`),$=e("ValueIdValueArray",`VId extends ${r} ? [valueId: VId, value: ${I}<VId>] : never`,y+" Ids and types in "+je,`<VId = ${r}>`,0),i=e(y+pe,`(...[valueId, value]: ${$})`+Ze,st($e+y+" Id, and "+y)),u=e("GetValueChange",`(valueId: ${r}) => ValueChange`,ie+" returning information about any Value's changes during a "+ze),p=e(T+c,`(${o}, getValueChange: ${u}${xe})`+Ze,rt(9)),b=e(v+c,`(${o})`+Ze,rt(10)),C=e("ValueListenerArgsArray",`VId extends ${r} ? [${o}, valueId: VId, newValue: ${I}<VId> ${xe}, oldValue: ${I}<VId> ${xe}, getValueChange: ${u} ${xe}] : never`,"Value args for ValueListener",`<VId = ${r}>`,0);return[d,s,r,I,i,p,b,e(y+c,`(...[${t}, valueId, newValue, oldValue, getValueChange]: `+C+")"+Ze,rt(11)),e(ye+y+c,`(${o}, valueId: Id, invalidValues: any[])`+Ze,rt(12))]},(t,l)=>e(Me+c,`(${t}: ${l}, getTransactionChanges: GetTransactionChanges, getTransactionLog: GetTransactionLog)`+Ze,ie+" listening to the completion of a "+ze)],Mt=(e,t=a,l=a)=>`store.${e}(${t})`+(l?" as "+l:a),Jt=(e,t=a)=>`fluent(() => ${Mt(e,t)})`,zt=(e,t=a,l=a)=>`store.${e}(${t?t+", ":a}proxy(listener)${l?", "+l:a})`,Wt=(e,t,n)=>{const[o,s,$,V,x,R,S,A]=Nt(),[E,D,O]=Lt(e,t,x),[N,G,L]=jt($,E,D,O),J=ae(),z=(e=0)=>de(J,(([t,l,n,o,d],s)=>{const r=e?[s+`: ${d}(${t}): ${l} => ${n},`]:[s+d+`(${t}): ${l};`];return e||F(r,At(o)),W(r,a),r})),B=(e,t,l,n,o,d=a)=>xt(J,e,[t,l,n,o,d]),U=(e,t,l,n,o,d=a,s=a,r=a)=>B(ht[e]+t+(4==e?ke:a)+l,d,n,(n==H?Jt:Mt)(ht[e]+(4==e?ke:a)+l,s,e?void 0:n),o,r),_=(e,t,l,n=a,o=a,d=1,s=a)=>B(i+e+c,(n?n+", ":a)+ve+": "+t+(d?", mutator?: boolean":a),we,zt(i+e+c,o,d?"mutator":a),l,s),Z=`./${St(n)}.d`,H=St(n,1),Q=St(H),q=[],K=ae();let Y=[],te=[];if(s(1,Z,H,`create${H} as create${H}Decl`),X(e))s(null,l,b);else{s(0,l,"CellChange"),s(null,l,u);const[e,t,n,o,c,i,y,T,v,V,R,S,A,O,G,L,J,z,B,F,X,te,le,oe]=N(Q,H),de=ae();E(((e,t)=>{const l=`<'${e}'>`,a=[$(t+p,o+l,Ee+` the '${e}' `+p),$(t+p+He,c+l,Ee+` the '${e}' `+p+Qe),$(t+h,i+l,at(e)),$(t+h+He,y+l,at(e,1)),$(t+f+we,T+l,`A Cell Id for the '${e}' `+p),$(t+f+pe,V+l,st(`a Cell Id and value from a Row in the '${e}' `+p)),$(t+h+pe,R+l,st(`a Row Id from the '${e}' Table, and a Cell iterator`)),$(t+p+f+pe,S+l,st(`a Cell Id from anywhere in the '${e}' Table, and a count of how many times it appears`))];se(de,e,a),s(1,Z,...a)})),s(1,Z,e,t,n,T,A,O,G,L,J,z,B,F,X,te,le,oe),Y=[e,t,n,T,O,G,L,J,z,B,F,X,te,le,de],j([[e],[d],[H,"tables: "+t,"tables"],[H]],(([e,t,l],n)=>U(n,a,b,e,lt(1,n),t,l))),U(0,a,C,n+Le,nt(p,je)),U(5,a,p,_e,ot(p,je),"tableCallback: "+A,"tableCallback as any"),E(((e,t,l)=>{const[n,o,s,r,I,c,$,i]=ne(de,e);j([[n],[d],[H,"table: "+o,", table"],[H]],(([n,o,d=a],s)=>U(s,t,p,n,it(e,s),o,l+d))),U(0,t,p+w,u,nt(f,"the whole of "+ct(e)),a,l),U(5,t,p+f,_e,ot(p+f,"the whole of "+ct(e)),"tableCellCallback: "+i,l+", tableCellCallback as any"),U(0,t,h+"Count","number","Gets the number of Rows in the "+ct(e),a,l),U(0,t,m,u,nt(h,ct(e)),a,l),U(0,t,g,u,nt(h,ct(e),1),"cellId?: "+I+Ge,l+", cellId, descending, offset, limit"),U(5,t,h,_e,ot(h,ct(e)),"rowCallback: "+$,l+", rowCallback as any"),j([[s],[d],[H,", row: "+r,", row"],[H],[H,", partialRow: "+r,", partialRow"]],(([n,o=a,d=a],s)=>U(s,t,h,n,ut(e,s),De+o,l+", rowId"+d))),U(6,t,h,we+xe,"Add a new Row to "+ct(e),"row: "+r+", reuseIds?: boolean",l+", row, reuseIds"),U(0,t,w,I+Le,nt(f,$t(e)),De,l+", rowId"),U(5,t,f,_e,ot(f,$t(e)),De+", cellCallback: "+c,l+", rowId, cellCallback as any"),D(e,((n,o,s,r,I)=>{const c="Map"+St(o,1);se(K,o,c);const $=o+(k(s)?xe:a);j([[$],[d],[H,`, cell: ${o} | `+c,", cell as any"],[H]],(([o,d=a,s=a],c)=>U(c,t+I,f,o,pt(e,n,c),De+d,l+", rowId, "+r+s))),U(1,t+I,p+f,d,Ct[1]+` the '${n}' Cell anywhere in `+ct(e),a,l+", "+r)}))})),U(0,a,b+Te,Te,lt(1,6)),U(2,a,b+Te,H,lt(1,7),"tablesJson: "+Te,"tables"+Te),_(b,O,lt(1,8)+" changes"),_(C,G,It(2,0,1)),_(p,L,It(3,0),`tableId: ${n} | null`,"tableId"),_(p+w,J,It(14,3,1),`tableId: ${n} | null`,"tableId"),_(h+"Count",z,It(15,3),`tableId: ${n} | null`,"tableId"),_(m,B,It(4,3,1),`tableId: ${n} | null`,"tableId"),_(g,F,It(13,3,1),Et("tableId: TId",`cellId: ${T}<TId>`+xe,"descending: boolean","offset: number","limit: number"+xe),Et("tableId","cellId","descending","offset","limit"),1,"<TId extends TableId>"),_(h,X,It(5,3),`tableId: ${n} | null, rowId: IdOrNull`,"tableId, rowId"),_(w,te,It(6,5,1),`tableId: ${n} | null, rowId: IdOrNull`,"tableId, rowId"),_(f,le,It(7,5),`tableId: ${n} | null, rowId: IdOrNull, cellId: ${M(E((e=>ne(de,e)?.[4]??a))," | ")} | null`,"tableId, rowId, cellId"),_(ye+f,oe,Ae+" whenever an invalid Cell change was attempted","tableId: IdOrNull, rowId: IdOrNull, cellId: IdOrNull","tableId, rowId, cellId"),s(1,Z,...ee(K)),W(q,".set"+b+Oe+"({",kt(E(((e,t,l)=>[`[${l}]: {`,...D(e,((e,t,l,n)=>`[${n}]: {[${x(Pt(r),`'${r}'`)}]: ${x(Pt(t),`'${t}'`)}${k(l)?a:`, [${x(Pt(I),`'${I}'`)}]: `+(P(l)?x(Pt(l),`'${l}'`):l)}},`)),"},"]))),"})")}if(X(t))s(null,l,T);else{const[e,t,n,o,c,$,i,u,p]=G(Q,H);s(1,Z,e,t,n,c,$,i,u,p),te=[e,t,n,$,i,u],j([[e],[d],[H,"values: "+t,"values"],[H],[H,"partialValues: "+t,"partialValues"]],(([e,t,l],n)=>U(n,a,T,e,lt(2,n),t,l))),U(0,a,v,n+Le,nt(y,je)),U(5,a,y,"void",ot(y,je),"valueCallback: "+c,"valueCallback as any"),O(((e,t,l,n,o)=>{const s="Map"+St(t,1);se(K,t,s),j([[t],[d],[H,`value: ${t} | `+s,", value as any"],[H]],(([t,l,d=a],s)=>U(s,o,y,t,bt(e,s),l,n+d)))})),U(0,a,T+Te,Te,lt(2,6)),U(2,a,T+Te,H,lt(2,7),"valuesJson: "+Te,"values"+Te),_(T,$,lt(2,8)+" changes"),_(v,i,It(10,0,1)),_(y,u,It(11,0),`valueId: ${n} | null`,"valueId"),_(ye+y,p,Ae+" whenever an invalid Value change was attempted","valueId: IdOrNull","valueId"),s(1,Z,...ee(K)),s(0,l,"ValueChange"),W(q,".set"+T+Oe+"({",O(((e,t,l,n)=>[`[${n}]: {[${x(Pt(r),`'${r}'`)}]: ${x(Pt(t),`'${t}'`)}${k(l)?a:`, [${x(Pt(I),`'${I}'`)}]: `+(P(l)?x(Pt(l),`'${l}'`):l)}},`])),"})")}U(0,a,"Content",`[${b}, ${T}]`,lt(0,0)),U(2,a,"Content",H,lt(0,2),`[tables, values]: [${b}, ${T}]`,"[tables, values]"),U(2,a,Je,H,`Applies a set of ${Je} to the Store`,"transactionChanges: "+Je,"transactionChanges"),oe(K,((e,t)=>$(t,`(cell: ${e}${xe}) => `+e,`Takes a ${e} Cell value and returns another`))),s(null,l,"DoRollback",we,"IdOrNull",Te,"Store",Je),s(0,l,"Get"+Je,"GetTransactionLog"),U(0,a,Te,Te,lt(0,6)),U(2,a,Te,H,lt(0,7),"tablesAndValuesJson: "+Te,"tablesAndValuesJson"),U(7,a,ze,"Return",We,ge,"actions, doRollback","<Return>"),U(7,a,"start"+Me,H,Be),U(7,a,"finish"+Me,H,Fe,me,"doRollback");const le=L(Q,H);return _("Start"+Me,le,Ae+" just before the start of the "+ze,a,a,0),_("WillFinish"+Me,le,Ae+" just before "+Ue,a,a,0),_("DidFinish"+Me,le,Ae+" just after "+Ue,a,a,0),U(7,a,"call"+c,H,"Manually provoke a listener to be called","listenerId: Id","listenerId"),U(3,a,c,H,"Remove a listener that was previously added to "+je,"listenerId: Id","listenerId"),B("getStore",a,"Store","store",Ct[0]+" the underlying Store object"),s(1,l,"createStore"),s(1,Z,H,`create${H} as create${H}Decl`,le),x("store",["createStore()",...q]),V("fluent","actions: () => Store",["actions();",`return ${Q};`]),V("proxy","listener: any",`(_: Store, ...params: any[]) => listener(${Q}, ...params)`),x(Q,["{",...z(1),"}"]),[o(...R(0),...S(),fe+" interface "+H+" {",...z(0),"}",a,At(`Creates a ${H} object`),fe+" function create"+H+"(): "+H+";"),o(...R(1),fe+" const create"+H+": typeof create"+H+"Decl = () => {",...A(),`return Object.freeze(${Q});`,"};"),Y,te]},Bt=e=>$+e,Ft=e=>Et(Bt(e),Bt(e)+Ce),Ut="debugIds?: boolean",_t="debugIds={debugIds}",Zt="then"+he,Ht="Parameter",Qt=": (parameter: "+Ht+", store: Store) => ",qt="const contextValue = useContext(Context);",Kt=", based on a parameter",Xt=": ",Yt="<"+Ht+",>",el=Ht+"ized"+pe+"<"+Ht+">",tl="rowId",ll="rowId={rowId}",al=", separator, debugIds",nl="separator?: ReactElement | string",ol="then?: (store: Store",dl=Et(ol+")"+Ze,Zt),sl="then, then"+Ce,rl=tl+Xt+we,Il="View",cl=(e,...t)=>Et(...t,ve+": "+e,ve+he,"mutator?: boolean"),$l=(...e)=>Et(...e,ve,ve+Ce,"mutator"),il=(e,t,n,o,d)=>{const[s,r,I,$,i,V,x,R]=Nt(),[S,P,A]=Lt(e,t,i),E=`./${St(n)}.d`,D=`./${St(n)}-ui-react.d`,O="tinybase/ui-react",N=St(n,1),G=St(N),L=N+"Or"+N+we,j=G+"Or"+N+we,J=G+`={${G}}`,z=ae(),B=(e,t,l,n,o,d=a)=>(r(1,D,e+" as "+e+"Decl"),xt(z,e,[t,l,n,o,d])),U=(e,t,l,n,o,d=a)=>B("use"+e,t,l,n,o,d),_=(e,t,l,n,o=a,d=a,s=a,I=a,c=a)=>(r(1,O,`use${t} as use${t}Core`),U(e,Et(o,K,I),l,ee+`(${j}, use${t}Core, [`+(d||a)+(c?"], ["+c:a)+"]);",n,s)),Z=(e,t,l,a)=>B(e,t,1,l,a),H=(e=0)=>de(z,(([t,l,n,o,d],s)=>{const r=e?[fe+` const ${s}: typeof ${s}Decl = ${d}(${t}): ${1==l?"any":l} =>`,n]:[fe+` function ${s}${d}(${t}): ${1==l?"ComponentReturnType":l};`];return e||F(r,At(o)),W(r,a),r}));r(null,l,we,"Store",pe,Ht+"ized"+pe),r(0,O,"ComponentReturnType"),r(1,O,"useCellIds"),r(null,O,"ExtraProps"),r(0,E,N);const Q=I(L,N+" | "+we,`Used when you need to refer to a ${N} in a React hook or component`),q=I(Pe+Se,Ot(G+Ve+N,G+`ById?: {[${G}Id: Id]: ${N}}`),`Used with the ${Pe} component, so that a `+N+" can be passed into the context of an application");r(0,"react","ReactElement","ComponentType"),r(1,"react","React"),r(1,D,Q,q);const K=j+Ve+Q;i("{createContext, useContext, useMemo}","React"),i("Context",`createContext<[${N}?, {[${G}Id: Id]: ${N}}?]>([])`),U("Create"+N,`create: () => ${N}, create`+he,N,"\n// eslint-disable-next-line react-hooks/exhaustive-deps\nuseMemo(create, createDeps)",`Create a ${N} within a React application with convenient memoization`);const Y=U(N,"id?: Id",N+xe,["{",qt,"return id == null ? contextValue[0] : contextValue[1]?.[id];","}"],`Get a reference to a ${N} from within a ${Pe} component context`),ee=$("useHook",j+`: ${Q} | undefined, hook: (...params: any[]) => any, preParams: any[], postParams: any[] = []`,[`const ${G} = ${Y}(${j} as Id);`,`return hook(...preParams, ((${j} == null || typeof ${j} == 'string')`,`? ${G} : ${j})?.getStore(), ...postParams)`]),te=$("getProps","getProps: ((id: any) => ExtraProps) | undefined, id: Id","(getProps == null) ? ({} as ExtraProps) : getProps(id)"),le=$("wrap",Et("children: any","separator?: any","encloseWithId?: boolean","id?: Id"),["const separated = separator==null || !Array.isArray(children)"," ? children"," : children.map((child, c) => (c > 0 ? [separator, child] : child));","return encloseWithId ? [id, ':{', separated, '}'] : separated;"]),oe=$("useCustomOrDefaultCellIds",Et("customCellIds: Ids | undefined","tableId: Id","rowId: Id",`${j}?: ${Q} | undefined`),[`const defaultCellIds = ${ee}(${j}, useCellIds, [tableId, rowId]);`,"return customCellIds ?? defaultCellIds;"]),se=i("NullComponent","() => null");if(!X(e)){const[e,t,n,d,s,i,y,T,v,V,x,R,A,O,L]=o;r(null,E,e,t,n,s,i,y,T,v,V,x,R,A,O),r(0,E,d),r(1,E,N),r(null,l,u,"IdOrNull");const j=$("tableView",`{${G}, rowComponent, getRowComponentProps, customCellIds`+al+"}: any, rowIds: Ids, tableId: Id, defaultRowComponent: React.ComponentType<any>",["const Row = rowComponent ?? defaultRowComponent;",`return ${le}(rowIds.map((rowId) => (`,"<Row","{..."+te+"(getRowComponentProps, rowId)}","key={rowId}","tableId={tableId}",ll,"customCellIds={customCellIds}",J,_t,"/>","))",al,", tableId,",");"]),z=$("getDefaultTableComponent","tableId: Id",M(S(((e,t,l)=>`tableId == ${l} ? ${t}TableView : `)))+se),W=$("getDefaultCellComponent","tableId: Id, cellId: Id",M(S(((e,t,l)=>`tableId == ${l} ? ${M(P(e,((e,l,a,n,o)=>`cellId == ${n} ? `+t+o+"CellView : ")))+se} : `)))+se);_(b,b,e,lt(1,0)+ue);const B=_(C,C,n+Le,nt(p,je)+ue);_(Ne+b+pe,Ne+b+pe,el,lt(1,9)+Kt,Et(Bt(b)+Qt+t,Bt(b)+he),Ft(b),Yt,Et(ol,`tables: ${t})`+Ze,Zt),sl),_(be+b+pe,be+b+pe,pe,lt(1,12),a,a,a,dl,sl);const F=I(f+Se,Ot("tableId?: TId","rowId: Id","cellId?: CId",G+Ve+N,Ut),dt($e+f),`<TId extends ${n}, CId extends ${d}<TId>>`),U=I(h+Se,Ot("tableId?: TId","rowId: Id",G+Ve+N,"cellComponents?: {readonly [CId in "+d+`<TId>]?: ComponentType<${F}<TId, CId>>;}`,`getCellComponentProps?: (cellId: ${d}<TId>) => ExtraProps`,`customCellIds?: ${d}<TId>[]`,nl,Ut),dt($e+h),`<TId extends ${n}>`),H=I(p+Se,Ot("tableId?: TId",G+Ve+N,`rowComponent?: ComponentType<${U}<TId>>`,"getRowComponentProps?: (rowId: Id) => ExtraProps","customCellIds?: CellId<TId>[]",nl,Ut),dt($e+p),`<TId extends ${n}>`),Q=I("Sorted"+p+Se,Ot("tableId?: TId","cellId?: "+d+"<TId>","descending?: boolean","offset?: number","limit?: number",G+Ve+N,`rowComponent?: ComponentType<${U}<TId>>`,"getRowComponentProps?: (rowId: Id) => ExtraProps","customCellIds?: CellId<TId>[]",nl,Ut),dt($e+"sorted "+p),`<TId extends ${n}>`),q=I(b+Se,Ot(G+Ve+N,"tableComponents?: {readonly [TId in "+n+`]?: ComponentType<${H}<TId>>;}`,`getTableComponentProps?: (tableId: ${n}) => ExtraProps`,nl,Ut),dt(tt(1,1)));r(1,D,q,H,Q,U,F),Z(b+Il,"{"+G+", tableComponents, getTableComponentProps"+al+"}: "+q,[le+`(${B}(${G}).map((tableId) => {`,"const Table = (tableComponents?.[tableId] ?? "+z+"(tableId)) as React.ComponentType<TableProps<typeof tableId>>;","return <Table",`{...${te}(getTableComponentProps, tableId)}`,"tableId={tableId}","key={tableId}",J,_t,"/>;","}), separator)"],lt(1,13)+ue),S(((e,t,l)=>{const[n,o,d,s,I]=ne(L,e);r(null,E,n,o,d,s,I),_(t+p,p,n,it(e)+ue,a,l),_(t+p+w,p+w,u,nt(f,"the whole of "+ct(e))+ue,a,l);const c=_(t+m,m,u,nt(h,ct(e))+ue,a,l),$=_(t+g,g,u,nt(h,ct(e),1)+ue,"cellId?: "+I+", descending?: boolean, offset?: number, limit?: number",l+", cellId, descending, offset, limit");_(t+h,h,d,ut(e)+ue,rl,Et(l,tl)),_(t+w,w,I+Le,nt(f,$t(e))+ue,rl,Et(l,tl)),_(Ne+t+p+pe,Ne+p+pe,el,it(e,9)+Kt,Et(Bt(p)+Qt+o,Bt(p)+he),Et(l,Ft(p)),Yt,Et(ol,`table: ${o})`+Ze,Zt),sl),_(be+t+p+pe,be+p+pe,pe,it(e,12),a,l,a,dl,sl),_(Ne+t+h+pe,Ne+h+pe,el,ut(e,9)+Kt,Et(rl,Bt(h)+Qt+s,Bt(h)+he),Et(l,tl,Ft(h)),Yt,Et(ol,`row: ${s})`+Ze,Zt),sl),_("Add"+t+h+pe,"Add"+h+pe,el,ut(e,10)+Kt,Et(Bt(h)+Qt+s,Bt(h)+he),Et(l,Ft(h)),Yt,"then?: ("+Et(rl+xe,"store: Store","row: "+s+")"+Ze,"then"+he)+", reuseRowIds?: boolean",sl+", reuseRowIds"),_(Ne+t+ke+h+pe,Ne+ke+h+pe,el,ut(e,11)+Kt,Et(rl,Bt(ke+h)+Qt+s,Bt(ke+h)+he),Et(l,tl,Ft(ke+h)),Yt,Et(ol,`partialRow: ${s})`+Ze,Zt),sl),_(be+t+h+pe,be+h+pe,pe,ut(e,12),rl,Et(l,tl),a,dl,sl);const i=Z(t+h+Il,"{rowId, "+G+", cellComponents, getCellComponentProps, customCellIds"+al+`}: ${U}<'${e}'>`,[le+`(${oe}(customCellIds, `+l+`, rowId, ${G}).map((cellId: ${I}) => {`,"const Cell = (cellComponents?.[cellId] ?? "+W+`(${l}, cellId)) as React.ComponentType<CellProps<typeof `+l+", typeof cellId>>;","return <Cell",`{...${te}(getCellComponentProps, cellId)} `,"key={cellId}",`tableId={${l}}`,ll,"cellId={cellId}",J,_t,"/>;","})"+al+", rowId)"],ut(e,13)+ue);Z(t+"Sorted"+p+Il,"{cellId, descending, offset, limit, ...props}: "+Q+`<'${e}'>`,j+"(props, "+$+`(cellId, descending, offset, limit, props.${G}), ${l}, ${i});`,it(e,13)+", sorted"+ue),Z(t+p+Il,`props: ${H}<'${e}'>`,j+"(props, "+c+`(props.${G}), ${l}, ${i});`,it(e,13)+ue),P(e,((n,o,d,s,I)=>{const c="Map"+St(o,1);r(0,E,c),r(1,E,c);const $=_(t+I+f,f,o+(k(d)?xe:a),pt(e,n)+ue,rl,Et(l,tl,s));_(Ne+t+I+f+pe,Ne+f+pe,el,pt(e,n,9)+Kt,Et(rl,Bt(f)+Qt+o+" | "+c,Bt(f)+he),Et(l,tl,s,Ft(f)),Yt,Et(ol,`cell: ${o} | ${c})`+Ze,Zt),sl),_(be+t+I+f+pe,be+f+pe,pe,pt(e,n,12),Et(rl,"forceDel?: boolean"),Et(l,tl,s,"forceDel"),a,dl,sl),Z(t+I+f+Il,`{rowId, ${G}, debugIds}: `+F+`<'${e}', '${n}'>`,[le+`('' + ${$}(rowId, `+G+`) ?? '', undefined, debugIds, ${s})`],pt(e,n,13)+ue)}))}));const K=M(S((e=>ne(L,e)?.[4]??a))," | ");_(b+c,b+c,_e,lt(1,8)+" changes",cl(s),$l()),_(C+c,C+c,_e,It(2,0,1),cl(i),$l()),_(p+c,p+c,_e,It(3,0),cl(y,`tableId: ${n} | null`),$l("tableId")),_(p+w+c,p+w+c,_e,It(14,3,1),cl(T,`tableId: ${n} | null`),$l("tableId")),_(m+c,m+c,_e,It(4,3,1),cl(V,`tableId: ${n} | null`),$l("tableId")),_(g+c,g+c,_e,It(13,3,1),cl(x,`tableId: ${n} | null`,"cellId: "+K+xe,"descending: boolean","offset: number","limit: number"+xe),$l("tableId","cellId","descending","offset","limit")),_(h+c,h+c,_e,It(5,3),cl(R,`tableId: ${n} | null`,tl+": IdOrNull"),$l("tableId",tl)),_(w+c,w+c,_e,It(6,5,1),cl(A,`tableId: ${n} | null`,tl+": IdOrNull"),$l("tableId",tl)),_(f+c,f+c,_e,It(7,5),cl(O,`tableId: ${n} | null`,tl+": IdOrNull",`cellId: ${K} | null`),$l("tableId",tl,"cellId"))}if(!X(t)){const[e,t,l,n,o,s]=d;r(null,E,...d),r(1,E,N);const i=$("getDefaultValueComponent","valueId: Id",M(A(((e,t,l,a,n)=>`valueId == ${a} ? `+n+"ValueView : ")))+se);_(T,T,e,lt(2,0)+ue);const u=_(v,v,l+Le,nt(y,je)+ue);_(Ne+T+pe,Ne+T+pe,el,lt(2,9)+Kt,Et(Bt(T)+Qt+t,Bt(T)+he),Ft(T),Yt,Et(ol,`values: ${t})`+Ze,Zt),sl),_(Ne+ke+T+pe,Ne+ke+T+pe,el,lt(2,11)+Kt,Et(Bt(ke+T)+Qt+t,Bt(ke+T)+he),Ft(ke+T),Yt,Et(ol,`partialValues: ${t})`+Ze,Zt),sl),_(be+T+pe,be+T+pe,pe,lt(2,12),a,a,a,dl,sl);const p=I(y+Se,Ot("valueId?: VId",G+Ve+N,Ut),dt("a Value"),`<VId extends ${l}>`),b=I(T+Se,Ot(G+Ve+N,"valueComponents?: {readonly [VId in "+l+`]?: ComponentType<${p}<VId>>;}`,`getValueComponentProps?: (valueId: ${l}) => ExtraProps`,nl,Ut),dt(tt(2,1)));r(1,D,b,p),Z(T+Il,"{"+G+", valueComponents, getValueComponentProps"+al+"}: "+b,[le+`(${u}(${G}).map((valueId) => {`,"const Value = valueComponents?.[valueId] ?? "+i+"(valueId);","return <Value",`{...${te}(getValueComponentProps, valueId)}`,"key={valueId}",J,_t,"/>;","}), separator)"],lt(2,13)+ue),A(((e,t,l,n,o)=>{const d="Map"+St(t,1);r(0,E,d),r(1,E,d);const s=_(o+y,y,t,bt(e)+ue,a,n);_(Ne+o+y+pe,Ne+y+pe,el,bt(e,9)+Kt,Et(Bt(y)+Qt+t+" | "+d,Bt(y)+he),Et(n,Ft(y)),Yt,Et(ol,`value: ${t} | ${d})`+Ze,Zt),sl),_(be+o+y+pe,be+y+pe,pe,bt(e,12),a,n,a,dl,sl),Z(o+y+Il,`{${G}, debugIds}: ${p}<'${e}'>`,[le+`('' + ${s}(`+G+`) ?? '', undefined, debugIds, ${n})`],bt(e,13)+ue)})),_(T+c,T+c,_e,lt(2,8)+" changes",cl(n),$l()),_(v+c,v+c,_e,It(10,0,1),cl(o),$l()),_(y+c,y+c,_e,It(11,0),cl(s,`valueId: ${l} | null`),$l("valueId"))}return Z(Pe,`{${G}, ${G}ById, children}: `+q+" & {children: React.ReactNode}",["{",qt,"return (","<Context."+Pe,"value={useMemo(",`() => [${G} ?? contextValue[0], {...contextValue[1], ...${G}ById}],`,`[${G}, ${G}ById, contextValue],`,")}>","{children}",`</Context.${Pe}>`,");","}"],"Wraps part of an application in a context that provides default objects to be used by hooks and components within"),[s(...V(0),...x(),...H(0)),s(...V(1),...R(),...H(1))]},ul=(e,t,l)=>{if(X(e)&&X(t))return[a,a,a,a];const[n,o,d,s]=Wt(e,t,l);return[n,o,...il(e,t,l,d,s)]},pl=JSON.parse,bl="prettier/",Cl=bl+"plugins/",hl={parser:"typescript",singleQuote:!0,trailingComma:"all",bracketSpacing:!1,jsdocSingleLineComment:!1},ml=Gt((e=>{const t=()=>{const t=pl(e.getTablesSchemaJson());return!X(t)||G(e.getTableIds(),(l=>{const a=e.getRowIds(l),n=ae();if(G(a,(t=>G(e.getCellIds(l,t),(a=>{const o=e.getCell(l,t,a),d=re(n,a,(()=>[N(o),ae(),[0],0])),[s,r,[I]]=d,c=re(r,o,(()=>0))+1;return c>I&&(d[2]=[c,o]),se(r,o,c),d[3]++,s==N(o)})))))return t[l]={},te(n,(([e,,[,n],o],d)=>{t[l][d]={[r]:e,...o==D(a)?{[I]:n}:{}}})),1}))?t:{}},l=()=>{const t=pl(e.getValuesSchemaJson());return X(t)&&e.forEachValue(((e,l)=>{t[e]={[r]:N(l)}})),t},a=e=>ul(t(),l(),e),n=async e=>{const t=["d.ts","ts","d.ts","tsx"],l=[];let n;try{n=(await import(bl+"standalone")).format,W(l,await import(Cl+"estree"),await import(Cl+"typescript"))}catch(e){n=async e=>e}return await O(J(a(e),(async(e,a)=>Rt(await n(e,{...hl,plugins:l,filepath:"_."+t[a]})))))};return H({getStoreStats:t=>{let l=0,a=0,n=0;const o={};return e.forEachTable(((e,d)=>{l++;let s=0,r=0;const I={};d(((e,l)=>{s++;let a=0;l((()=>a++)),r+=a,t&&(I[e]={rowCells:a})})),a+=s,n+=r,t&&(o[e]={tableRows:s,tableCells:r,rows:I})})),{totalTables:l,totalRows:a,totalCells:n,totalValues:D(e.getValueIds()),jsonLength:D(e.getJson()),...t?{detail:{tables:o}}:{}}},getStoreTablesSchema:t,getStoreValuesSchema:l,getStoreApi:a,getPrettyStoreApi:n,getStore:()=>e})}));e.createTools=ml},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseTools={});
